{"ast":null,"code":"\"use strict\";\n\nvar _taggedTemplateLiteral = require(\"E:/DW/wasai-cinema/node_modules/@babel/runtime/helpers/taggedTemplateLiteral.js\").default;\n\nvar _templateObject, _templateObject2, _templateObject3, _templateObject4, _templateObject5, _templateObject6, _templateObject7, _templateObject8, _templateObject9, _templateObject10, _templateObject11, _templateObject12;\n\nrequire(\"core-js/modules/es.function.name.js\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar codegen_1 = require(\"../../compile/codegen\");\n\nvar util_1 = require(\"../../compile/util\");\n\nvar error = {\n  message: function message(_ref) {\n    var _ref$params = _ref.params,\n        min = _ref$params.min,\n        max = _ref$params.max;\n    return max === undefined ? (0, codegen_1.str)(_templateObject || (_templateObject = _taggedTemplateLiteral([\"must contain at least \", \" valid item(s)\"])), min) : (0, codegen_1.str)(_templateObject2 || (_templateObject2 = _taggedTemplateLiteral([\"must contain at least \", \" and no more than \", \" valid item(s)\"])), min, max);\n  },\n  params: function params(_ref2) {\n    var _ref2$params = _ref2.params,\n        min = _ref2$params.min,\n        max = _ref2$params.max;\n    return max === undefined ? (0, codegen_1._)(_templateObject3 || (_templateObject3 = _taggedTemplateLiteral([\"{minContains: \", \"}\"])), min) : (0, codegen_1._)(_templateObject4 || (_templateObject4 = _taggedTemplateLiteral([\"{minContains: \", \", maxContains: \", \"}\"])), min, max);\n  }\n};\nvar def = {\n  keyword: \"contains\",\n  type: \"array\",\n  schemaType: [\"object\", \"boolean\"],\n  before: \"uniqueItems\",\n  trackErrors: true,\n  error: error,\n  code: function code(cxt) {\n    var gen = cxt.gen,\n        schema = cxt.schema,\n        parentSchema = cxt.parentSchema,\n        data = cxt.data,\n        it = cxt.it;\n    var min;\n    var max;\n    var minContains = parentSchema.minContains,\n        maxContains = parentSchema.maxContains;\n\n    if (it.opts.next) {\n      min = minContains === undefined ? 1 : minContains;\n      max = maxContains;\n    } else {\n      min = 1;\n    }\n\n    var len = gen.const(\"len\", (0, codegen_1._)(_templateObject5 || (_templateObject5 = _taggedTemplateLiteral([\"\", \".length\"])), data));\n    cxt.setParams({\n      min: min,\n      max: max\n    });\n\n    if (max === undefined && min === 0) {\n      (0, util_1.checkStrictMode)(it, \"\\\"minContains\\\" == 0 without \\\"maxContains\\\": \\\"contains\\\" keyword ignored\");\n      return;\n    }\n\n    if (max !== undefined && min > max) {\n      (0, util_1.checkStrictMode)(it, \"\\\"minContains\\\" > \\\"maxContains\\\" is always invalid\");\n      cxt.fail();\n      return;\n    }\n\n    if ((0, util_1.alwaysValidSchema)(it, schema)) {\n      var cond = (0, codegen_1._)(_templateObject6 || (_templateObject6 = _taggedTemplateLiteral([\"\", \" >= \", \"\"])), len, min);\n      if (max !== undefined) cond = (0, codegen_1._)(_templateObject7 || (_templateObject7 = _taggedTemplateLiteral([\"\", \" && \", \" <= \", \"\"])), cond, len, max);\n      cxt.pass(cond);\n      return;\n    }\n\n    it.items = true;\n    var valid = gen.name(\"valid\");\n\n    if (max === undefined && min === 1) {\n      validateItems(valid, function () {\n        return gen.if(valid, function () {\n          return gen.break();\n        });\n      });\n    } else if (min === 0) {\n      gen.let(valid, true);\n      if (max !== undefined) gen.if((0, codegen_1._)(_templateObject8 || (_templateObject8 = _taggedTemplateLiteral([\"\", \".length > 0\"])), data), validateItemsWithCount);\n    } else {\n      gen.let(valid, false);\n      validateItemsWithCount();\n    }\n\n    cxt.result(valid, function () {\n      return cxt.reset();\n    });\n\n    function validateItemsWithCount() {\n      var schValid = gen.name(\"_valid\");\n      var count = gen.let(\"count\", 0);\n      validateItems(schValid, function () {\n        return gen.if(schValid, function () {\n          return checkLimits(count);\n        });\n      });\n    }\n\n    function validateItems(_valid, block) {\n      gen.forRange(\"i\", 0, len, function (i) {\n        cxt.subschema({\n          keyword: \"contains\",\n          dataProp: i,\n          dataPropType: util_1.Type.Num,\n          compositeRule: true\n        }, _valid);\n        block();\n      });\n    }\n\n    function checkLimits(count) {\n      gen.code((0, codegen_1._)(_templateObject9 || (_templateObject9 = _taggedTemplateLiteral([\"\", \"++\"])), count));\n\n      if (max === undefined) {\n        gen.if((0, codegen_1._)(_templateObject10 || (_templateObject10 = _taggedTemplateLiteral([\"\", \" >= \", \"\"])), count, min), function () {\n          return gen.assign(valid, true).break();\n        });\n      } else {\n        gen.if((0, codegen_1._)(_templateObject11 || (_templateObject11 = _taggedTemplateLiteral([\"\", \" > \", \"\"])), count, max), function () {\n          return gen.assign(valid, false).break();\n        });\n        if (min === 1) gen.assign(valid, true);else gen.if((0, codegen_1._)(_templateObject12 || (_templateObject12 = _taggedTemplateLiteral([\"\", \" >= \", \"\"])), count, min), function () {\n          return gen.assign(valid, true);\n        });\n      }\n    }\n  }\n};\nexports.default = def;","map":{"version":3,"mappings":"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","names":["error","message","params","min","max","undefined","def","keyword","type","schemaType","before","trackErrors","code","cxt","gen","schema","parentSchema","data","it","minContains","maxContains","opts","next","len","const","setParams","fail","cond","pass","items","valid","name","validateItems","if","break","let","validateItemsWithCount","result","reset","schValid","count","checkLimits","_valid","block","forRange","i","subschema","dataProp","dataPropType","util_1","Num","compositeRule","assign","exports"],"sourceRoot":"","sources":["../../../lib/vocabularies/applicator/contains.ts"],"sourcesContent":[null]},"metadata":{},"sourceType":"script"}