{"ast":null,"code":"//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport { QueryAdminAccount, QueryAdminInfo } from \"@/api/admin\";\nimport { QueryAllorder, CancleOneOrder, PostOeOrder, GetAlloe, PostOe } from \"@/api/order\"; //引入订单接口\n\nimport { parseTime } from \"@/plugins/DateTran\"; //日期格式转化\n\nimport { Admin_Login_JS } from \"@/plugins/AdminLogin\";\nexport default {\n  data: function data() {\n    return {\n      // 异常处理通知\n      form_index: -1,\n      formLabelWidth: '90px',\n      dialogSolveVisible: false,\n      form: {\n        statue: '',\n        result: ''\n      },\n      //测试用展开后电影数据\n      //  order_detail:[\n      //   {\n      //     order_id:\"123\",\n      //     user_id:\"12321321\",\n      //     movie_id:\"ji33232\",\n      //     arrn_id:\"ucbbr1\",\n      //     movie_name:\"刺杀小说家\",\n      //     seat_no:\"14\",\n      //     order_cost:232,\n      //     order_time:\"12:00\",\n      //     pay_time:\"13:00\",\n      //   },\n      // ],\n      // 测试用\n      activeNames: [],\n      //正式用\n      Oe_list: {},\n      //订单状态样式\n      cancled: {\n        cancle: true,\n        pay: false,\n        wait: false,\n        fail: false\n      },\n      paid: {\n        cancle: false,\n        pay: true,\n        wait: false,\n        fail: false\n      },\n      waited: {\n        cancle: false,\n        pay: false,\n        wait: true,\n        fail: false\n      },\n      failed: {\n        cancle: false,\n        pay: false,\n        wait: false,\n        fail: true\n      }\n    };\n  },\n  methods: {\n    //加载所有异常订单\n    LoadAllOe: function LoadAllOe() {\n      var _this = this;\n\n      GetAlloe().then(function (res) {\n        if (res.code == 200) {\n          console.log(res);\n          _this.Oe_list = res.data;\n\n          for (var i = 0; i < _this.Oe_list.length; i++) {\n            //传入的时候改变其状态为文字表示\n            if (_this.Oe_list[i].status == 0) {\n              _this.Oe_list[i].status = \"等待处理\";\n            }\n\n            if (_this.Oe_list[i].status == 1) {\n              _this.Oe_list[i].status = \"处理成功\";\n            }\n\n            _this.Oe_list[i].createTime = parseTime(new Date(_this.Oe_list[i].createTime));\n          }\n        }\n      });\n    },\n    //更改状态显示样式\n    changeOrderCss: function changeOrderCss(item) {\n      if (item.status == \"已被撤销\") {\n        return this.cancled;\n      } //黄色\n\n\n      if (item.status == \"处理成功\") {\n        return this.paid;\n      } //绿色\n\n\n      if (item.status == \"处理异常\") {\n        return this.waited;\n      } //蓝色\n\n\n      if (item.status == \"等待处理\") {\n        return this.failed;\n      } //红色\n\n    },\n    //处理按钮和通知\n    Operation_SolveOrder: function Operation_SolveOrder(index) {\n      this.dialogSolveVisible = true;\n      this.form_index = index;\n    },\n    Operation_SolveOrder_confirm: function Operation_SolveOrder_confirm(index) {\n      var _this2 = this;\n\n      if (this.form.statue == \"等待处理\") {\n        var sta = 0;\n      }\n\n      if (this.form.statue == \"处理成功\") {\n        var sta = 1;\n      }\n\n      var vo = {\n        id: this.Oe_list[this.form_index].id,\n        result: this.form.result,\n        status: sta\n      }; //处理异常接口\n\n      PostOe(vo).then(function (res) {\n        if (res.code == 200) {\n          if (res.data.success == \"success\") {\n            _this2.$message({\n              message: res.data.msg,\n              type: res.data.success\n            });\n\n            _this2.Oe_list[_this2.form_index].status = vo.id;\n          } else {\n            _this2.$message.error(\"处理异常失败\");\n          }\n        } else {\n          _this2.$message.error(\"请求处理失败,请检查网络\");\n        }\n      });\n      console.log(vo);\n\n      if (this.form.statue == \"处理成功\") {\n        this.Oe_list[index].statue = \"处理成功\";\n        this.Oe_list[index].solve_statue = true;\n      } else {\n        this.testlist[index].statue = \"等待处理\";\n      }\n\n      this.dialogSolveVisible = false;\n    },\n    changePad: function changePad(n) {\n      if (this.activeNames.indexOf(n) == -1) {\n        this.activeNames.push(n);\n      } else {\n        this.activeNames.pop(n);\n      }\n    }\n  },\n  created: function created() {\n    this.LoadAllOe();\n  }\n};","map":{"version":3,"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAqEA;AACA,2F,CAAA;;AACA,+C,CAAA;;AACA;AACA;AACAA,MADA,kBACA;AACA;AACA;AACAC,oBAFA;AAGAC,4BAHA;AAIAC,+BAJA;AAKAC;AACAC,kBADA;AAEAC;AAFA,OALA;AASA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACAC,qBAzBA;AA0BA;AACAC,iBA3BA;AA4BA;AACAC;AAAAC;AAAAC;AAAAC;AAAAC;AAAA,OA7BA;AA8BAC;AAAAJ;AAAAC;AAAAC;AAAAC;AAAA,OA9BA;AA+BAE;AAAAL;AAAAC;AAAAC;AAAAC;AAAA,OA/BA;AAgCAG;AAAAN;AAAAC;AAAAC;AAAAC;AAAA;AAhCA;AAkCA,GApCA;AAqCAI;AACA;AACAC,aAFA,uBAEA;AAAA;;AACAC;AACA,6BACA;AACAC;AACA;;AACA,yDACA;AACA;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAEA;AACA;AACA,OAdA;AAeA,KAlBA;AAmBA;AACAC;AACA;AAAA;AAAA,OADA,CACA;;;AACA;AAAA;AAAA,OAFA,CAEA;;;AACA;AAAA;AAAA,OAHA,CAGA;;;AACA;AAAA;AAAA,OAJA,CAIA;;AACA,KAzBA;AA0BA;AACAC;AACA;AACA;AACA,KA9BA;AA+BAC;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AACAC,4CADA;AAEAlB,gCAFA;AAGAmB;AAHA,QAHA,CAQA;;AACAC;AACA;AACA,6CACA;AACA;AAAAC;AAAAC;AAAA;;AACA;AACA,WAJA,MAKA;AACA;AACA;AACA,SATA,MAUA;AACA;AACA;AACA,OAdA;AAgBAR;;AACA,sCACA;AAAA;AACA;AAAA,OAFA,MAGA;AACA;AACA;;AAEA;AACA,KAjEA;AAkEAS;AACA;AACA;AACA,OAFA,MAGA;AACA;AACA;AACA;AAzEA,GArCA;AAgHAC;AACA;AACA;AAlHA","names":["data","form_index","formLabelWidth","dialogSolveVisible","form","statue","result","activeNames","Oe_list","cancled","cancle","pay","wait","fail","paid","waited","failed","methods","LoadAllOe","GetAlloe","console","changeOrderCss","Operation_SolveOrder","Operation_SolveOrder_confirm","id","status","PostOe","message","type","changePad","created"],"sourceRoot":"src/views/admin_panel","sources":["admin_order_error_report.vue"],"sourcesContent":["<template>\r\n  <div class=\"outbox\">\r\n    <!-- 头部显示栏 -->\r\n      <div class=\"header\">\r\n        <el-row>\r\n          <el-col :span=\"5\" class=\"header-item\" >订单ID</el-col>\r\n          <el-col :span=\"4\" class=\"header-item\" style=\"padding-left:0px\" >上报人</el-col>\r\n          <el-col :span=\"5\" class=\"header-item\" style=\"padding-left:70px\">异常处理状态</el-col>\r\n          <el-col :span=\"10\" class=\"header-item\" style=\"padding-left:170px\">操作</el-col>\r\n        </el-row>\r\n      </div>\r\n    <!-- 循环显示订单信息栏位-测试用-->\r\n      <!-- <div class=\"order-box\" :key=\"index\" v-for=\"(item,index) in testlist\">\r\n        <el-row>\r\n          <el-col span=\"8\" class=\"order-box-item1\" >{{item.id}}</el-col>\r\n          <el-col span=\"4\" class=\"order-box-item1\" >{{item.money}}</el-col>\r\n          <el-col span=\"6\" class=\"order-box-item2\" ><div :class=\"changeOrderCss(item)\">{{item.statue}}</div></el-col>\r\n          <el-col span=\"6\" class=\"order-box-item3\" ><el-button class=\"wait1\" @click=\"Operation_CancleOrder(index)\">撤销订单</el-button> &nbsp; <el-button class=\"fail1\" @click=\"Operation_FailOrder(index)\">上报异常</el-button></el-col>\r\n        </el-row>\r\n      </div> -->\r\n  <!-- 折叠面板 -->\r\n  <el-collapse v-model=\"activeNames\">\r\n  <el-collapse-item  :name=\"index\" disabled :key=\"index\" v-for=\"(item,index) in Oe_list\" style=\"border-bottom:1px solid black;\">\r\n    <template slot=\"title\">\r\n    <el-row style=\"background-color:white;width: 1800px;height: 48px;\">\r\n         <el-col :span=\"5\" class=\"order-box-item1\">{{item.id}}</el-col>\r\n         <el-col :span=\"6\" class=\"order-box-item1\">{{item.reviewer}}</el-col>\r\n         <el-col :span=\"5\" class=\"order-box-item2\"><div :class=\"changeOrderCss(item)\">{{item.status}}</div></el-col>\r\n         <el-col :span=\"8\" class=\"order-box-item3\">\r\n           <el-button class=\"wait1\" @click=\"Operation_SolveOrder(index)\">处理异常</el-button>\r\n           <el-button class=\"PadButton\" @click=\"changePad(index)\">展开收起</el-button>\r\n         </el-col>\r\n        </el-row>\r\n        <!-- 折叠的面板内容,这里用来显示详细信息 -->\r\n    </template>\r\n    <div class=\"collapse-panel-item\">ID:{{item.id}}</div>\r\n    <div class=\"collapse-panel-item\">订单ID:{{item.oid}}</div>\r\n    <div class=\"collapse-panel-item\">异常原因:{{item.reason}}</div>\r\n    <div class=\"collapse-panel-item\">上报人:{{item.reviewer}}</div>\r\n    <div class=\"collapse-panel-item\">是否已处理完成:{{item.status}}</div>\r\n    <div class=\"collapse-panel-item\">处理结果:{{item.result}}</div>\r\n    <div class=\"collapse-panel-item\">创建时间:{{item.createTime}}</div>\r\n    \r\n  </el-collapse-item>\r\n</el-collapse>\r\n<!-- 异常处理通知面板 -->\r\n<el-dialog title=\"异常上报\" :visible.sync=\"dialogSolveVisible\">\r\n  <el-form :model=\"form\">\r\n    <el-form-item label=\"处理结果\" :label-width=\"formLabelWidth\">\r\n      <el-input v-model=\"form.result\" autocomplete=\"off\"></el-input>\r\n    </el-form-item>\r\n    <el-form-item label=\"处理状态\" :label-width=\"formLabelWidth\">\r\n       <el-select v-model=\"form.statue\" placeholder=\"请选择处理状态\">\r\n        <el-option label=\"处理成功\" value=\"处理成功\"></el-option>\r\n        <el-option label=\"等待处理\" value=\"等待处理\"></el-option>\r\n      </el-select>\r\n    </el-form-item>\r\n  </el-form>\r\n  <div slot=\"footer\" class=\"dialog-footer\">\r\n    <el-button @click=\"dialogSolveVisible = false\">取 消</el-button>\r\n    <el-button type=\"primary\" @click=\"Operation_SolveOrder_confirm(form_index)\">确 定</el-button>\r\n  </div>\r\n</el-dialog>\r\n\r\n<!-- 底部 -->\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { QueryAdminAccount,QueryAdminInfo } from \"@/api/admin\";\r\nimport { QueryAllorder ,CancleOneOrder,PostOeOrder,GetAlloe,PostOe} from \"@/api/order\";//引入订单接口\r\nimport { parseTime } from \"@/plugins/DateTran\";//日期格式转化\r\nimport { Admin_Login_JS } from \"@/plugins/AdminLogin\";\r\nexport default {\r\n  data(){\r\n    return{\r\n      // 异常处理通知\r\n       form_index:-1,\r\n       formLabelWidth: '90px',\r\n       dialogSolveVisible: false,\r\n        form: {\r\n          statue:'',\r\n          result:'',\r\n        },\r\n        //测试用展开后电影数据\r\n        //  order_detail:[\r\n        //   {\r\n        //     order_id:\"123\",\r\n        //     user_id:\"12321321\",\r\n        //     movie_id:\"ji33232\",\r\n        //     arrn_id:\"ucbbr1\",\r\n        //     movie_name:\"刺杀小说家\",\r\n        //     seat_no:\"14\",\r\n        //     order_cost:232,\r\n        //     order_time:\"12:00\",\r\n        //     pay_time:\"13:00\",\r\n        //   },\r\n          \r\n        // ],\r\n         // 测试用\r\n         activeNames: [],\r\n         //正式用\r\n         Oe_list:{},\r\n         //订单状态样式\r\n           cancled:{cancle:true,pay:false,wait:false,fail:false},\r\n           paid:{cancle:false,pay:true,wait:false,fail:false},\r\n           waited:{cancle:false,pay:false,wait:true,fail:false},\r\n           failed:{cancle:false,pay:false,wait:false,fail:true},\r\n    }\r\n  },\r\n  methods:{\r\n    //加载所有异常订单\r\n    LoadAllOe(){\r\n         GetAlloe().then((res)=>{\r\n           if(res.code==200)\r\n           {\r\n             console.log(res);\r\n                  this.Oe_list=res.data;\r\n             for(var i=0;i<this.Oe_list.length;i++)\r\n          {\r\n            //传入的时候改变其状态为文字表示\r\n          if(this.Oe_list[i].status==0){this.Oe_list[i].status=\"等待处理\"}\r\n          if(this.Oe_list[i].status==1){this.Oe_list[i].status=\"处理成功\"}\r\n            this.Oe_list[i].createTime=parseTime(new Date( this.Oe_list[i].createTime));\r\n\r\n            }\r\n           }\r\n         })\r\n    },\r\n    //更改状态显示样式\r\n    changeOrderCss:function(item){\r\n          if(item.status==\"已被撤销\"){return this.cancled}//黄色\r\n          if(item.status==\"处理成功\"){return this.paid}   //绿色\r\n          if(item.status==\"处理异常\"){return this.waited} //蓝色\r\n          if(item.status==\"等待处理\"){return this.failed} //红色\r\n      },\r\n    //处理按钮和通知\r\n    Operation_SolveOrder:function(index){\r\n      this.dialogSolveVisible=true;\r\n      this.form_index=index;\r\n    },\r\n    Operation_SolveOrder_confirm:function(index){\r\n       if(this.form.statue==\"等待处理\"){var sta=0}\r\n        if(this.form.statue==\"处理成功\"){var sta=1}\r\n       const vo={\r\n          id:this.Oe_list[this.form_index].id,\r\n          result: this.form.result,\r\n          status:sta,\r\n       }\r\n       //处理异常接口\r\n       PostOe(vo).then((res)=>{\r\n         if(res.code==200){\r\n         if(res.data.success==\"success\")\r\n         {\r\n           this.$message({message:res.data.msg,type:res.data.success});\r\n           this.Oe_list[this.form_index].status=vo.id;\r\n         }\r\n         else{\r\n           this.$message.error(\"处理异常失败\")\r\n         }\r\n         }\r\n         else{\r\n           this.$message.error(\"请求处理失败,请检查网络\")\r\n         }\r\n         }\r\n       )\r\n       console.log(vo);\r\n      if(this.form.statue==\"处理成功\")\r\n      {this.Oe_list[index].statue=\"处理成功\";\r\n      this.Oe_list[index].solve_statue=true;}\r\n        else{\r\n            this.testlist[index].statue=\"等待处理\";\r\n        }\r\n        \r\n        this.dialogSolveVisible = false;\r\n    },\r\n    changePad:function(n){\r\n      if(this.activeNames.indexOf(n)==-1){\r\n        this.activeNames.push(n);\r\n      }\r\n       else{\r\n         this.activeNames.pop(n);\r\n       }\r\n    }\r\n  },\r\n  created:function(){\r\n    this.LoadAllOe()\r\n  },\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n.outbox{\r\n  overflow: auto;\r\n  background-color: rgb(143, 143, 143);\r\n  height:760px;\r\n}\r\n/* 头部栏 */\r\n.header-item{\r\n  background-color:rgb(177, 177, 177);text-align:left;height: 50px;line-height: 50px;font-size: 20px;\r\n  font-weight: 600 !important;\r\n}\r\n.order-box{\r\n  border-bottom-color:rgb(187, 187, 187);height: 50px;text-align: center;font-size: 16px;line-height: 50px;\r\n  padding-bottom:5px;\r\n  border-bottom:1px solid black;\r\n}\r\n/* 按钮样式 */\r\n.pay{\r\n    margin-top:10px;\r\n    height:30px;\r\n    text-align: center;\r\n    display:inline-block;\r\n    border: 1px solid rgb(150 214 164);\r\n    color: rgb(150 214 164);\r\n    line-height: 30px;\r\n    width:80px;\r\n    margin: 0,auto;\r\n    border-radius: 5px;\r\n    background-color: rgb(231 254 180);\r\n}\r\n.cancle{\r\n    margin-top:10px;\r\n    height:30px;\r\n    text-align: center;\r\n    display:inline-block;\r\n    border: 1px solid rgb(189, 124, 2);\r\n    color: rgb(196, 130, 7);\r\n    line-height: 30px;\r\n    width:80px;\r\n    margin: 0,auto;\r\n    background-color: rgb(252, 188, 69);\r\n    border-radius: 5px;\r\n}\r\n.wait{\r\n    margin-top:10px;\r\n    height:30px;\r\n    text-align: center;\r\n    display:inline-block;\r\n    border: 1px solid rgb(95 164 251);\r\n    color: rgb(95 164 251);\r\n    line-height: 30px;\r\n    width:80px;\r\n    margin: 0,auto;\r\n    border-radius: 5px;\r\n    background-color: rgb(240 246 253);\r\n}\r\n.fail{margin-top:10px;\r\n    height:30px;\r\n    text-align: center;\r\n    display:inline-block;\r\n    border: 1px solid rgb(251 95 114);\r\n    color: rgb(251 95 114);\r\n    line-height: 30px;\r\n    width:80px;\r\n    margin: 0,auto;\r\n    border-radius: 5px;\r\n    background-color: rgb(255 215 220);}\r\n    /* 操作区域按钮样式，与前面的分割 */\r\n  .wait1{\r\n\r\n    margin-top:7px;\r\n    text-align: center;\r\n    display:inline-block;\r\n    border: 1px solid rgb(95 164 251);\r\n    color: rgb(95 164 251);\r\n    border-radius: 5px;\r\n    background-color: rgb(240 246 253);\r\n    height:35px;\r\n    margin-left: 60px;\r\n    \r\n}\r\n.fail1{\r\n    height:35px;\r\n    text-align: center;\r\n    display:inline-block;\r\n    border: 1px solid rgb(251 95 114);\r\n    color: rgb(251 95 114);\r\n    border-radius: 5px;\r\n    background-color: rgb(255 215 220);}\r\n    /* 折叠面板 */\r\n    .order-box-item1{\r\n      color:black;\r\n      font-size:18px;\r\n    }\r\n    .PadButton{\r\n    height:35px;\r\n    text-align: center;\r\n    display:inline-block;\r\n    border: 1px solid rgb(68, 68, 68);\r\n    color: rgb(0, 0, 0);\r\n    border-radius: 5px;\r\n    background-color: rgb(238, 238, 238);\r\n    margin-left:90px !important;\r\n    }\r\n    /* 折叠板展开后的 */\r\n    .collapse-panel-item{\r\n        text-indent:2em;font-size:14px\r\n    }\r\n    /* 异常显示栏 */\r\n    .order-box-item2{\r\n      right:50px;\r\n    }\r\n</style>"]},"metadata":{},"sourceType":"module"}