{"ast":null,"code":"\"use strict\";\n\nvar _taggedTemplateLiteral = require(\"E:/DW/wasai-cinema/node_modules/@babel/runtime/helpers/taggedTemplateLiteral.js\").default;\n\nvar _toConsumableArray = require(\"E:/DW/wasai-cinema/node_modules/@babel/runtime/helpers/toConsumableArray.js\").default;\n\nvar _defineProperty = require(\"E:/DW/wasai-cinema/node_modules/@babel/runtime/helpers/defineProperty.js\").default;\n\nvar _inherits = require(\"E:/DW/wasai-cinema/node_modules/@babel/runtime/helpers/inherits.js\").default;\n\nvar _createSuper = require(\"E:/DW/wasai-cinema/node_modules/@babel/runtime/helpers/createSuper.js\").default;\n\nvar _createClass = require(\"E:/DW/wasai-cinema/node_modules/@babel/runtime/helpers/createClass.js\").default;\n\nvar _classCallCheck = require(\"E:/DW/wasai-cinema/node_modules/@babel/runtime/helpers/classCallCheck.js\").default;\n\nvar _templateObject, _templateObject2;\n\nrequire(\"core-js/modules/es.regexp.exec.js\");\n\nrequire(\"core-js/modules/es.regexp.test.js\");\n\nrequire(\"core-js/modules/es.error.cause.js\");\n\nrequire(\"core-js/modules/es.object.to-string.js\");\n\nrequire(\"core-js/modules/es.array.concat.js\");\n\nrequire(\"core-js/modules/es.array.splice.js\");\n\nrequire(\"core-js/modules/es.array.slice.js\");\n\nrequire(\"core-js/modules/es.array.join.js\");\n\nrequire(\"core-js/modules/es.string.replace.js\");\n\nrequire(\"core-js/modules/es.json.stringify.js\");\n\nrequire(\"core-js/modules/es.regexp.to-string.js\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.regexpCode = exports.getEsmExportName = exports.getProperty = exports.safeStringify = exports.stringify = exports.strConcat = exports.addCodeArg = exports.str = exports._ = exports.nil = exports._Code = exports.Name = exports.IDENTIFIER = exports._CodeOrName = void 0;\n\nvar _CodeOrName = /*#__PURE__*/_createClass(function _CodeOrName() {\n  _classCallCheck(this, _CodeOrName);\n});\n\nexports._CodeOrName = _CodeOrName;\nexports.IDENTIFIER = /^[a-z$_][a-z$_0-9]*$/i;\n\nvar Name = /*#__PURE__*/function (_CodeOrName2) {\n  _inherits(Name, _CodeOrName2);\n\n  var _super = _createSuper(Name);\n\n  function Name(s) {\n    var _this;\n\n    _classCallCheck(this, Name);\n\n    _this = _super.call(this);\n    if (!exports.IDENTIFIER.test(s)) throw new Error(\"CodeGen: name must be a valid identifier\");\n    _this.str = s;\n    return _this;\n  }\n\n  _createClass(Name, [{\n    key: \"toString\",\n    value: function toString() {\n      return this.str;\n    }\n  }, {\n    key: \"emptyStr\",\n    value: function emptyStr() {\n      return false;\n    }\n  }, {\n    key: \"names\",\n    get: function get() {\n      return _defineProperty({}, this.str, 1);\n    }\n  }]);\n\n  return Name;\n}(_CodeOrName);\n\nexports.Name = Name;\n\nvar _Code = /*#__PURE__*/function (_CodeOrName3) {\n  _inherits(_Code, _CodeOrName3);\n\n  var _super2 = _createSuper(_Code);\n\n  function _Code(code) {\n    var _this2;\n\n    _classCallCheck(this, _Code);\n\n    _this2 = _super2.call(this);\n    _this2._items = typeof code === \"string\" ? [code] : code;\n    return _this2;\n  }\n\n  _createClass(_Code, [{\n    key: \"toString\",\n    value: function toString() {\n      return this.str;\n    }\n  }, {\n    key: \"emptyStr\",\n    value: function emptyStr() {\n      if (this._items.length > 1) return false;\n      var item = this._items[0];\n      return item === \"\" || item === '\"\"';\n    }\n  }, {\n    key: \"str\",\n    get: function get() {\n      var _a;\n\n      return (_a = this._str) !== null && _a !== void 0 ? _a : this._str = this._items.reduce(function (s, c) {\n        return \"\".concat(s).concat(c);\n      }, \"\");\n    }\n  }, {\n    key: \"names\",\n    get: function get() {\n      var _a;\n\n      return (_a = this._names) !== null && _a !== void 0 ? _a : this._names = this._items.reduce(function (names, c) {\n        if (c instanceof Name) names[c.str] = (names[c.str] || 0) + 1;\n        return names;\n      }, {});\n    }\n  }]);\n\n  return _Code;\n}(_CodeOrName);\n\nexports._Code = _Code;\nexports.nil = new _Code(\"\");\n\nfunction _(strs) {\n  var code = [strs[0]];\n  var i = 0;\n\n  for (var _len = arguments.length, args = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {\n    args[_key - 1] = arguments[_key];\n  }\n\n  while (i < args.length) {\n    addCodeArg(code, args[i]);\n    code.push(strs[++i]);\n  }\n\n  return new _Code(code);\n}\n\nexports._ = _;\nvar plus = new _Code(\"+\");\n\nfunction str(strs) {\n  var expr = [safeStringify(strs[0])];\n  var i = 0;\n\n  for (var _len2 = arguments.length, args = new Array(_len2 > 1 ? _len2 - 1 : 0), _key2 = 1; _key2 < _len2; _key2++) {\n    args[_key2 - 1] = arguments[_key2];\n  }\n\n  while (i < args.length) {\n    expr.push(plus);\n    addCodeArg(expr, args[i]);\n    expr.push(plus, safeStringify(strs[++i]));\n  }\n\n  optimize(expr);\n  return new _Code(expr);\n}\n\nexports.str = str;\n\nfunction addCodeArg(code, arg) {\n  if (arg instanceof _Code) code.push.apply(code, _toConsumableArray(arg._items));else if (arg instanceof Name) code.push(arg);else code.push(interpolate(arg));\n}\n\nexports.addCodeArg = addCodeArg;\n\nfunction optimize(expr) {\n  var i = 1;\n\n  while (i < expr.length - 1) {\n    if (expr[i] === plus) {\n      var res = mergeExprItems(expr[i - 1], expr[i + 1]);\n\n      if (res !== undefined) {\n        expr.splice(i - 1, 3, res);\n        continue;\n      }\n\n      expr[i++] = \"+\";\n    }\n\n    i++;\n  }\n}\n\nfunction mergeExprItems(a, b) {\n  if (b === '\"\"') return a;\n  if (a === '\"\"') return b;\n\n  if (typeof a == \"string\") {\n    if (b instanceof Name || a[a.length - 1] !== '\"') return;\n    if (typeof b != \"string\") return \"\".concat(a.slice(0, -1)).concat(b, \"\\\"\");\n    if (b[0] === '\"') return a.slice(0, -1) + b.slice(1);\n    return;\n  }\n\n  if (typeof b == \"string\" && b[0] === '\"' && !(a instanceof Name)) return \"\\\"\".concat(a).concat(b.slice(1));\n  return;\n}\n\nfunction strConcat(c1, c2) {\n  return c2.emptyStr() ? c1 : c1.emptyStr() ? c2 : str(_templateObject || (_templateObject = _taggedTemplateLiteral([\"\", \"\", \"\"])), c1, c2);\n}\n\nexports.strConcat = strConcat; // TODO do not allow arrays here\n\nfunction interpolate(x) {\n  return typeof x == \"number\" || typeof x == \"boolean\" || x === null ? x : safeStringify(Array.isArray(x) ? x.join(\",\") : x);\n}\n\nfunction stringify(x) {\n  return new _Code(safeStringify(x));\n}\n\nexports.stringify = stringify;\n\nfunction safeStringify(x) {\n  return JSON.stringify(x).replace(/\\u2028/g, \"\\\\u2028\").replace(/\\u2029/g, \"\\\\u2029\");\n}\n\nexports.safeStringify = safeStringify;\n\nfunction getProperty(key) {\n  return typeof key == \"string\" && exports.IDENTIFIER.test(key) ? new _Code(\".\".concat(key)) : _(_templateObject2 || (_templateObject2 = _taggedTemplateLiteral([\"[\", \"]\"])), key);\n}\n\nexports.getProperty = getProperty; //Does best effort to format the name properly\n\nfunction getEsmExportName(key) {\n  if (typeof key == \"string\" && exports.IDENTIFIER.test(key)) {\n    return new _Code(\"\".concat(key));\n  }\n\n  throw new Error(\"CodeGen: invalid export name: \".concat(key, \", use explicit $id name mapping\"));\n}\n\nexports.getEsmExportName = getEsmExportName;\n\nfunction regexpCode(rx) {\n  return new _Code(rx.toString());\n}\n\nexports.regexpCode = regexpCode;","map":{"version":3,"mappings":"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","names":["_CodeOrName","exports","Name","s","test","Error","str","_Code","code","_items","length","item","_str","_a","reduce","c","_names","names","_","strs","i","args","addCodeArg","push","plus","expr","safeStringify","optimize","arg","interpolate","res","mergeExprItems","undefined","splice","a","b","slice","strConcat","c1","c2","emptyStr","x","Array","isArray","join","stringify","JSON","replace","getProperty","key","getEsmExportName","regexpCode","rx","toString"],"sourceRoot":"","sources":["../../../lib/compile/codegen/code.ts"],"sourcesContent":[null]},"metadata":{},"sourceType":"script"}