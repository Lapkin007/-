{"ast":null,"code":"\"use strict\";\n\nvar _typeof = require(\"E:/DW/wasai-cinema/node_modules/@babel/runtime/helpers/typeof.js\").default;\n\nvar _createForOfIteratorHelper = require(\"E:/DW/wasai-cinema/node_modules/@babel/runtime/helpers/createForOfIteratorHelper.js\").default;\n\nrequire(\"core-js/modules/es.array.map.js\");\n\nrequire(\"core-js/modules/es.array.includes.js\");\n\nrequire(\"core-js/modules/es.string.includes.js\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar equal = require(\"fast-deep-equal\");\n\nvar SCALAR_TYPES = [\"number\", \"integer\", \"string\", \"boolean\", \"null\"];\n\nfunction getDef() {\n  return {\n    keyword: \"uniqueItemProperties\",\n    type: \"array\",\n    schemaType: \"array\",\n    compile: function compile(keys, parentSchema) {\n      var scalar = getScalarKeys(keys, parentSchema);\n      return function (data) {\n        if (data.length <= 1) return true;\n\n        for (var k = 0; k < keys.length; k++) {\n          var key = keys[k];\n\n          if (scalar[k]) {\n            var hash = {};\n\n            var _iterator = _createForOfIteratorHelper(data),\n                _step;\n\n            try {\n              for (_iterator.s(); !(_step = _iterator.n()).done;) {\n                var x = _step.value;\n                if (!x || _typeof(x) != \"object\") continue;\n                var p = x[key];\n                if (p && _typeof(p) == \"object\") continue;\n                if (typeof p == \"string\") p = '\"' + p;\n                if (hash[p]) return false;\n                hash[p] = true;\n              }\n            } catch (err) {\n              _iterator.e(err);\n            } finally {\n              _iterator.f();\n            }\n          } else {\n            for (var i = data.length; i--;) {\n              var _x = data[i];\n              if (!_x || _typeof(_x) != \"object\") continue;\n\n              for (var j = i; j--;) {\n                var y = data[j];\n                if (y && _typeof(y) == \"object\" && equal(_x[key], y[key])) return false;\n              }\n            }\n          }\n        }\n\n        return true;\n      };\n    },\n    metaSchema: {\n      type: \"array\",\n      items: {\n        type: \"string\"\n      }\n    }\n  };\n}\n\nexports.default = getDef;\n\nfunction getScalarKeys(keys, schema) {\n  return keys.map(function (key) {\n    var _a, _b, _c;\n\n    var t = (_c = (_b = (_a = schema.items) === null || _a === void 0 ? void 0 : _a.properties) === null || _b === void 0 ? void 0 : _b[key]) === null || _c === void 0 ? void 0 : _c.type;\n    return Array.isArray(t) ? !t.includes(\"object\") && !t.includes(\"array\") : SCALAR_TYPES.includes(t);\n  });\n}\n\nmodule.exports = getDef;","map":{"version":3,"mappings":"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","names":["SCALAR_TYPES","getDef","keyword","type","schemaType","compile","keys","parentSchema","scalar","getScalarKeys","data","length","k","key","hash","x","p","i","j","y","equal","metaSchema","items","exports","schema","map","t","_a","properties","_b","_c","Array","isArray","includes","module"],"sourceRoot":"","sources":["../../src/definitions/uniqueItemProperties.ts"],"sourcesContent":[null]},"metadata":{},"sourceType":"script"}