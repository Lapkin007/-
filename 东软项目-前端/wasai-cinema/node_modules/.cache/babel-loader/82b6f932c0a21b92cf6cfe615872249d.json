{"ast":null,"code":"/*\n\tMIT License http://www.opensource.org/licenses/mit-license.php\n\tAuthor Tobias Koppers @sokra\n*/\n\"use strict\";\n\nvar _slicedToArray = require(\"E:/DW/wasai-cinema/node_modules/@babel/runtime/helpers/slicedToArray.js\").default;\n\nvar _assertThisInitialized = require(\"E:/DW/wasai-cinema/node_modules/@babel/runtime/helpers/assertThisInitialized.js\").default;\n\nvar _inherits = require(\"E:/DW/wasai-cinema/node_modules/@babel/runtime/helpers/inherits.js\").default;\n\nvar _createSuper = require(\"E:/DW/wasai-cinema/node_modules/@babel/runtime/helpers/createSuper.js\").default;\n\nvar _classCallCheck = require(\"E:/DW/wasai-cinema/node_modules/@babel/runtime/helpers/classCallCheck.js\").default;\n\nvar _createClass = require(\"E:/DW/wasai-cinema/node_modules/@babel/runtime/helpers/createClass.js\").default;\n\nvar _createForOfIteratorHelper = require(\"E:/DW/wasai-cinema/node_modules/@babel/runtime/helpers/createForOfIteratorHelper.js\").default;\n\nrequire(\"core-js/modules/es.array.slice.js\");\n\nrequire(\"core-js/modules/es.regexp.constructor.js\");\n\nrequire(\"core-js/modules/es.regexp.dot-all.js\");\n\nrequire(\"core-js/modules/es.regexp.exec.js\");\n\nrequire(\"core-js/modules/es.regexp.sticky.js\");\n\nrequire(\"core-js/modules/es.regexp.to-string.js\");\n\nrequire(\"core-js/modules/es.array.join.js\");\n\nrequire(\"core-js/modules/es.array.map.js\");\n\nrequire(\"core-js/modules/es.regexp.test.js\");\n\nrequire(\"core-js/modules/es.string.replace.js\");\n\nrequire(\"core-js/modules/es.error.cause.js\");\n\nrequire(\"core-js/modules/es.object.to-string.js\");\n\nrequire(\"core-js/modules/es.string.iterator.js\");\n\nrequire(\"core-js/modules/es.weak-map.js\");\n\nrequire(\"core-js/modules/web.dom-collections.iterator.js\");\n\nrequire(\"core-js/modules/es.map.js\");\n\nrequire(\"core-js/modules/es.set.js\");\n\nrequire(\"core-js/modules/es.object.keys.js\");\n\nvar getWatcherManager = require(\"./getWatcherManager\");\n\nvar LinkResolver = require(\"./LinkResolver\");\n\nvar EventEmitter = require(\"events\").EventEmitter;\n\nvar globToRegExp = require(\"glob-to-regexp\");\n\nvar watchEventSource = require(\"./watchEventSource\");\n\nvar EMPTY_ARRAY = [];\nvar EMPTY_OPTIONS = {};\n\nfunction addWatchersToSet(watchers, set) {\n  var _iterator = _createForOfIteratorHelper(watchers),\n      _step;\n\n  try {\n    for (_iterator.s(); !(_step = _iterator.n()).done;) {\n      var ww = _step.value;\n      var w = ww.watcher;\n\n      if (!set.has(w.directoryWatcher)) {\n        set.add(w.directoryWatcher);\n      }\n    }\n  } catch (err) {\n    _iterator.e(err);\n  } finally {\n    _iterator.f();\n  }\n}\n\nvar stringToRegexp = function stringToRegexp(ignored) {\n  var source = globToRegExp(ignored, {\n    globstar: true,\n    extended: true\n  }).source;\n  var matchingStart = source.slice(0, source.length - 1) + \"(?:$|\\\\/)\";\n  return matchingStart;\n};\n\nvar ignoredToFunction = function ignoredToFunction(ignored) {\n  if (Array.isArray(ignored)) {\n    var regexp = new RegExp(ignored.map(function (i) {\n      return stringToRegexp(i);\n    }).join(\"|\"));\n    return function (x) {\n      return regexp.test(x.replace(/\\\\/g, \"/\"));\n    };\n  } else if (typeof ignored === \"string\") {\n    var _regexp = new RegExp(stringToRegexp(ignored));\n\n    return function (x) {\n      return _regexp.test(x.replace(/\\\\/g, \"/\"));\n    };\n  } else if (ignored instanceof RegExp) {\n    return function (x) {\n      return ignored.test(x.replace(/\\\\/g, \"/\"));\n    };\n  } else if (ignored instanceof Function) {\n    return ignored;\n  } else if (ignored) {\n    throw new Error(\"Invalid option for 'ignored': \".concat(ignored));\n  } else {\n    return function () {\n      return false;\n    };\n  }\n};\n\nvar normalizeOptions = function normalizeOptions(options) {\n  return {\n    followSymlinks: !!options.followSymlinks,\n    ignored: ignoredToFunction(options.ignored),\n    poll: options.poll\n  };\n};\n\nvar normalizeCache = new WeakMap();\n\nvar cachedNormalizeOptions = function cachedNormalizeOptions(options) {\n  var cacheEntry = normalizeCache.get(options);\n  if (cacheEntry !== undefined) return cacheEntry;\n  var normalized = normalizeOptions(options);\n  normalizeCache.set(options, normalized);\n  return normalized;\n};\n\nvar WatchpackFileWatcher = /*#__PURE__*/function () {\n  function WatchpackFileWatcher(watchpack, watcher, files) {\n    var _this = this;\n\n    _classCallCheck(this, WatchpackFileWatcher);\n\n    this.files = Array.isArray(files) ? files : [files];\n    this.watcher = watcher;\n    watcher.on(\"initial-missing\", function (type) {\n      var _iterator2 = _createForOfIteratorHelper(_this.files),\n          _step2;\n\n      try {\n        for (_iterator2.s(); !(_step2 = _iterator2.n()).done;) {\n          var file = _step2.value;\n          if (!watchpack._missing.has(file)) watchpack._onRemove(file, file, type);\n        }\n      } catch (err) {\n        _iterator2.e(err);\n      } finally {\n        _iterator2.f();\n      }\n    });\n    watcher.on(\"change\", function (mtime, type) {\n      var _iterator3 = _createForOfIteratorHelper(_this.files),\n          _step3;\n\n      try {\n        for (_iterator3.s(); !(_step3 = _iterator3.n()).done;) {\n          var file = _step3.value;\n\n          watchpack._onChange(file, mtime, file, type);\n        }\n      } catch (err) {\n        _iterator3.e(err);\n      } finally {\n        _iterator3.f();\n      }\n    });\n    watcher.on(\"remove\", function (type) {\n      var _iterator4 = _createForOfIteratorHelper(_this.files),\n          _step4;\n\n      try {\n        for (_iterator4.s(); !(_step4 = _iterator4.n()).done;) {\n          var file = _step4.value;\n\n          watchpack._onRemove(file, file, type);\n        }\n      } catch (err) {\n        _iterator4.e(err);\n      } finally {\n        _iterator4.f();\n      }\n    });\n  }\n\n  _createClass(WatchpackFileWatcher, [{\n    key: \"update\",\n    value: function update(files) {\n      if (!Array.isArray(files)) {\n        if (this.files.length !== 1) {\n          this.files = [files];\n        } else if (this.files[0] !== files) {\n          this.files[0] = files;\n        }\n      } else {\n        this.files = files;\n      }\n    }\n  }, {\n    key: \"close\",\n    value: function close() {\n      this.watcher.close();\n    }\n  }]);\n\n  return WatchpackFileWatcher;\n}();\n\nvar WatchpackDirectoryWatcher = /*#__PURE__*/function () {\n  function WatchpackDirectoryWatcher(watchpack, watcher, directories) {\n    var _this2 = this;\n\n    _classCallCheck(this, WatchpackDirectoryWatcher);\n\n    this.directories = Array.isArray(directories) ? directories : [directories];\n    this.watcher = watcher;\n    watcher.on(\"initial-missing\", function (type) {\n      var _iterator5 = _createForOfIteratorHelper(_this2.directories),\n          _step5;\n\n      try {\n        for (_iterator5.s(); !(_step5 = _iterator5.n()).done;) {\n          var item = _step5.value;\n\n          watchpack._onRemove(item, item, type);\n        }\n      } catch (err) {\n        _iterator5.e(err);\n      } finally {\n        _iterator5.f();\n      }\n    });\n    watcher.on(\"change\", function (file, mtime, type) {\n      var _iterator6 = _createForOfIteratorHelper(_this2.directories),\n          _step6;\n\n      try {\n        for (_iterator6.s(); !(_step6 = _iterator6.n()).done;) {\n          var item = _step6.value;\n\n          watchpack._onChange(item, mtime, file, type);\n        }\n      } catch (err) {\n        _iterator6.e(err);\n      } finally {\n        _iterator6.f();\n      }\n    });\n    watcher.on(\"remove\", function (type) {\n      var _iterator7 = _createForOfIteratorHelper(_this2.directories),\n          _step7;\n\n      try {\n        for (_iterator7.s(); !(_step7 = _iterator7.n()).done;) {\n          var item = _step7.value;\n\n          watchpack._onRemove(item, item, type);\n        }\n      } catch (err) {\n        _iterator7.e(err);\n      } finally {\n        _iterator7.f();\n      }\n    });\n  }\n\n  _createClass(WatchpackDirectoryWatcher, [{\n    key: \"update\",\n    value: function update(directories) {\n      if (!Array.isArray(directories)) {\n        if (this.directories.length !== 1) {\n          this.directories = [directories];\n        } else if (this.directories[0] !== directories) {\n          this.directories[0] = directories;\n        }\n      } else {\n        this.directories = directories;\n      }\n    }\n  }, {\n    key: \"close\",\n    value: function close() {\n      this.watcher.close();\n    }\n  }]);\n\n  return WatchpackDirectoryWatcher;\n}();\n\nvar Watchpack = /*#__PURE__*/function (_EventEmitter) {\n  _inherits(Watchpack, _EventEmitter);\n\n  var _super = _createSuper(Watchpack);\n\n  function Watchpack(options) {\n    var _this3;\n\n    _classCallCheck(this, Watchpack);\n\n    _this3 = _super.call(this);\n    if (!options) options = EMPTY_OPTIONS;\n    _this3.options = options;\n    _this3.aggregateTimeout = typeof options.aggregateTimeout === \"number\" ? options.aggregateTimeout : 200;\n    _this3.watcherOptions = cachedNormalizeOptions(options);\n    _this3.watcherManager = getWatcherManager(_this3.watcherOptions);\n    _this3.fileWatchers = new Map();\n    _this3.directoryWatchers = new Map();\n    _this3._missing = new Set();\n    _this3.startTime = undefined;\n    _this3.paused = false;\n    _this3.aggregatedChanges = new Set();\n    _this3.aggregatedRemovals = new Set();\n    _this3.aggregateTimer = undefined;\n    _this3._onTimeout = _this3._onTimeout.bind(_assertThisInitialized(_this3));\n    return _this3;\n  }\n\n  _createClass(Watchpack, [{\n    key: \"watch\",\n    value: function watch(arg1, arg2, arg3) {\n      var _this4 = this;\n\n      var files, directories, missing, startTime;\n\n      if (!arg2) {\n        var _arg1$files = arg1.files;\n        files = _arg1$files === void 0 ? EMPTY_ARRAY : _arg1$files;\n        var _arg1$directories = arg1.directories;\n        directories = _arg1$directories === void 0 ? EMPTY_ARRAY : _arg1$directories;\n        var _arg1$missing = arg1.missing;\n        missing = _arg1$missing === void 0 ? EMPTY_ARRAY : _arg1$missing;\n        startTime = arg1.startTime;\n      } else {\n        files = arg1;\n        directories = arg2;\n        missing = EMPTY_ARRAY;\n        startTime = arg3;\n      }\n\n      this.paused = false;\n      var fileWatchers = this.fileWatchers;\n      var directoryWatchers = this.directoryWatchers;\n      var ignored = this.watcherOptions.ignored;\n\n      var filter = function filter(path) {\n        return !ignored(path);\n      };\n\n      var addToMap = function addToMap(map, key, item) {\n        var list = map.get(key);\n\n        if (list === undefined) {\n          map.set(key, item);\n        } else if (Array.isArray(list)) {\n          list.push(item);\n        } else {\n          map.set(key, [list, item]);\n        }\n      };\n\n      var fileWatchersNeeded = new Map();\n      var directoryWatchersNeeded = new Map();\n      var missingFiles = new Set();\n\n      if (this.watcherOptions.followSymlinks) {\n        var resolver = new LinkResolver();\n\n        var _iterator8 = _createForOfIteratorHelper(files),\n            _step8;\n\n        try {\n          for (_iterator8.s(); !(_step8 = _iterator8.n()).done;) {\n            var file = _step8.value;\n\n            if (filter(file)) {\n              var _iterator11 = _createForOfIteratorHelper(resolver.resolve(file)),\n                  _step11;\n\n              try {\n                for (_iterator11.s(); !(_step11 = _iterator11.n()).done;) {\n                  var innerFile = _step11.value;\n\n                  if (file === innerFile || filter(innerFile)) {\n                    addToMap(fileWatchersNeeded, innerFile, file);\n                  }\n                }\n              } catch (err) {\n                _iterator11.e(err);\n              } finally {\n                _iterator11.f();\n              }\n            }\n          }\n        } catch (err) {\n          _iterator8.e(err);\n        } finally {\n          _iterator8.f();\n        }\n\n        var _iterator9 = _createForOfIteratorHelper(missing),\n            _step9;\n\n        try {\n          for (_iterator9.s(); !(_step9 = _iterator9.n()).done;) {\n            var _file = _step9.value;\n\n            if (filter(_file)) {\n              var _iterator12 = _createForOfIteratorHelper(resolver.resolve(_file)),\n                  _step12;\n\n              try {\n                for (_iterator12.s(); !(_step12 = _iterator12.n()).done;) {\n                  var _innerFile = _step12.value;\n\n                  if (_file === _innerFile || filter(_innerFile)) {\n                    missingFiles.add(_file);\n                    addToMap(fileWatchersNeeded, _innerFile, _file);\n                  }\n                }\n              } catch (err) {\n                _iterator12.e(err);\n              } finally {\n                _iterator12.f();\n              }\n            }\n          }\n        } catch (err) {\n          _iterator9.e(err);\n        } finally {\n          _iterator9.f();\n        }\n\n        var _iterator10 = _createForOfIteratorHelper(directories),\n            _step10;\n\n        try {\n          for (_iterator10.s(); !(_step10 = _iterator10.n()).done;) {\n            var dir = _step10.value;\n\n            if (filter(dir)) {\n              var first = true;\n\n              var _iterator13 = _createForOfIteratorHelper(resolver.resolve(dir)),\n                  _step13;\n\n              try {\n                for (_iterator13.s(); !(_step13 = _iterator13.n()).done;) {\n                  var innerItem = _step13.value;\n\n                  if (filter(innerItem)) {\n                    addToMap(first ? directoryWatchersNeeded : fileWatchersNeeded, innerItem, dir);\n                  }\n\n                  first = false;\n                }\n              } catch (err) {\n                _iterator13.e(err);\n              } finally {\n                _iterator13.f();\n              }\n            }\n          }\n        } catch (err) {\n          _iterator10.e(err);\n        } finally {\n          _iterator10.f();\n        }\n      } else {\n        var _iterator14 = _createForOfIteratorHelper(files),\n            _step14;\n\n        try {\n          for (_iterator14.s(); !(_step14 = _iterator14.n()).done;) {\n            var _file2 = _step14.value;\n\n            if (filter(_file2)) {\n              addToMap(fileWatchersNeeded, _file2, _file2);\n            }\n          }\n        } catch (err) {\n          _iterator14.e(err);\n        } finally {\n          _iterator14.f();\n        }\n\n        var _iterator15 = _createForOfIteratorHelper(missing),\n            _step15;\n\n        try {\n          for (_iterator15.s(); !(_step15 = _iterator15.n()).done;) {\n            var _file3 = _step15.value;\n\n            if (filter(_file3)) {\n              missingFiles.add(_file3);\n              addToMap(fileWatchersNeeded, _file3, _file3);\n            }\n          }\n        } catch (err) {\n          _iterator15.e(err);\n        } finally {\n          _iterator15.f();\n        }\n\n        var _iterator16 = _createForOfIteratorHelper(directories),\n            _step16;\n\n        try {\n          for (_iterator16.s(); !(_step16 = _iterator16.n()).done;) {\n            var _dir = _step16.value;\n\n            if (filter(_dir)) {\n              addToMap(directoryWatchersNeeded, _dir, _dir);\n            }\n          }\n        } catch (err) {\n          _iterator16.e(err);\n        } finally {\n          _iterator16.f();\n        }\n      } // Close unneeded old watchers\n      // and update existing watchers\n\n\n      var _iterator17 = _createForOfIteratorHelper(fileWatchers),\n          _step17;\n\n      try {\n        for (_iterator17.s(); !(_step17 = _iterator17.n()).done;) {\n          var _step17$value = _slicedToArray(_step17.value, 2),\n              key = _step17$value[0],\n              w = _step17$value[1];\n\n          var needed = fileWatchersNeeded.get(key);\n\n          if (needed === undefined) {\n            w.close();\n            fileWatchers.delete(key);\n          } else {\n            w.update(needed);\n            fileWatchersNeeded.delete(key);\n          }\n        }\n      } catch (err) {\n        _iterator17.e(err);\n      } finally {\n        _iterator17.f();\n      }\n\n      var _iterator18 = _createForOfIteratorHelper(directoryWatchers),\n          _step18;\n\n      try {\n        for (_iterator18.s(); !(_step18 = _iterator18.n()).done;) {\n          var _step18$value = _slicedToArray(_step18.value, 2),\n              _key2 = _step18$value[0],\n              _w = _step18$value[1];\n\n          var _needed = directoryWatchersNeeded.get(_key2);\n\n          if (_needed === undefined) {\n            _w.close();\n\n            directoryWatchers.delete(_key2);\n          } else {\n            _w.update(_needed);\n\n            directoryWatchersNeeded.delete(_key2);\n          }\n        } // Create new watchers and install handlers on these watchers\n\n      } catch (err) {\n        _iterator18.e(err);\n      } finally {\n        _iterator18.f();\n      }\n\n      watchEventSource.batch(function () {\n        var _iterator19 = _createForOfIteratorHelper(fileWatchersNeeded),\n            _step19;\n\n        try {\n          for (_iterator19.s(); !(_step19 = _iterator19.n()).done;) {\n            var _step19$value = _slicedToArray(_step19.value, 2),\n                key = _step19$value[0],\n                _files = _step19$value[1];\n\n            var watcher = _this4.watcherManager.watchFile(key, startTime);\n\n            if (watcher) {\n              fileWatchers.set(key, new WatchpackFileWatcher(_this4, watcher, _files));\n            }\n          }\n        } catch (err) {\n          _iterator19.e(err);\n        } finally {\n          _iterator19.f();\n        }\n\n        var _iterator20 = _createForOfIteratorHelper(directoryWatchersNeeded),\n            _step20;\n\n        try {\n          for (_iterator20.s(); !(_step20 = _iterator20.n()).done;) {\n            var _step20$value = _slicedToArray(_step20.value, 2),\n                _key = _step20$value[0],\n                _directories = _step20$value[1];\n\n            var _watcher = _this4.watcherManager.watchDirectory(_key, startTime);\n\n            if (_watcher) {\n              directoryWatchers.set(_key, new WatchpackDirectoryWatcher(_this4, _watcher, _directories));\n            }\n          }\n        } catch (err) {\n          _iterator20.e(err);\n        } finally {\n          _iterator20.f();\n        }\n      });\n      this._missing = missingFiles;\n      this.startTime = startTime;\n    }\n  }, {\n    key: \"close\",\n    value: function close() {\n      this.paused = true;\n      if (this.aggregateTimer) clearTimeout(this.aggregateTimer);\n\n      var _iterator21 = _createForOfIteratorHelper(this.fileWatchers.values()),\n          _step21;\n\n      try {\n        for (_iterator21.s(); !(_step21 = _iterator21.n()).done;) {\n          var w = _step21.value;\n          w.close();\n        }\n      } catch (err) {\n        _iterator21.e(err);\n      } finally {\n        _iterator21.f();\n      }\n\n      var _iterator22 = _createForOfIteratorHelper(this.directoryWatchers.values()),\n          _step22;\n\n      try {\n        for (_iterator22.s(); !(_step22 = _iterator22.n()).done;) {\n          var _w2 = _step22.value;\n\n          _w2.close();\n        }\n      } catch (err) {\n        _iterator22.e(err);\n      } finally {\n        _iterator22.f();\n      }\n\n      this.fileWatchers.clear();\n      this.directoryWatchers.clear();\n    }\n  }, {\n    key: \"pause\",\n    value: function pause() {\n      this.paused = true;\n      if (this.aggregateTimer) clearTimeout(this.aggregateTimer);\n    }\n  }, {\n    key: \"getTimes\",\n    value: function getTimes() {\n      var directoryWatchers = new Set();\n      addWatchersToSet(this.fileWatchers.values(), directoryWatchers);\n      addWatchersToSet(this.directoryWatchers.values(), directoryWatchers);\n      var obj = Object.create(null);\n\n      var _iterator23 = _createForOfIteratorHelper(directoryWatchers),\n          _step23;\n\n      try {\n        for (_iterator23.s(); !(_step23 = _iterator23.n()).done;) {\n          var w = _step23.value;\n          var times = w.getTimes();\n\n          for (var _i = 0, _Object$keys = Object.keys(times); _i < _Object$keys.length; _i++) {\n            var file = _Object$keys[_i];\n            obj[file] = times[file];\n          }\n        }\n      } catch (err) {\n        _iterator23.e(err);\n      } finally {\n        _iterator23.f();\n      }\n\n      return obj;\n    }\n  }, {\n    key: \"getTimeInfoEntries\",\n    value: function getTimeInfoEntries() {\n      var map = new Map();\n      this.collectTimeInfoEntries(map, map);\n      return map;\n    }\n  }, {\n    key: \"collectTimeInfoEntries\",\n    value: function collectTimeInfoEntries(fileTimestamps, directoryTimestamps) {\n      var allWatchers = new Set();\n      addWatchersToSet(this.fileWatchers.values(), allWatchers);\n      addWatchersToSet(this.directoryWatchers.values(), allWatchers);\n      var safeTime = {\n        value: 0\n      };\n\n      var _iterator24 = _createForOfIteratorHelper(allWatchers),\n          _step24;\n\n      try {\n        for (_iterator24.s(); !(_step24 = _iterator24.n()).done;) {\n          var w = _step24.value;\n          w.collectTimeInfoEntries(fileTimestamps, directoryTimestamps, safeTime);\n        }\n      } catch (err) {\n        _iterator24.e(err);\n      } finally {\n        _iterator24.f();\n      }\n    }\n  }, {\n    key: \"getAggregated\",\n    value: function getAggregated() {\n      if (this.aggregateTimer) {\n        clearTimeout(this.aggregateTimer);\n        this.aggregateTimer = undefined;\n      }\n\n      var changes = this.aggregatedChanges;\n      var removals = this.aggregatedRemovals;\n      this.aggregatedChanges = new Set();\n      this.aggregatedRemovals = new Set();\n      return {\n        changes: changes,\n        removals: removals\n      };\n    }\n  }, {\n    key: \"_onChange\",\n    value: function _onChange(item, mtime, file, type) {\n      file = file || item;\n\n      if (!this.paused) {\n        this.emit(\"change\", file, mtime, type);\n        if (this.aggregateTimer) clearTimeout(this.aggregateTimer);\n        this.aggregateTimer = setTimeout(this._onTimeout, this.aggregateTimeout);\n      }\n\n      this.aggregatedRemovals.delete(item);\n      this.aggregatedChanges.add(item);\n    }\n  }, {\n    key: \"_onRemove\",\n    value: function _onRemove(item, file, type) {\n      file = file || item;\n\n      if (!this.paused) {\n        this.emit(\"remove\", file, type);\n        if (this.aggregateTimer) clearTimeout(this.aggregateTimer);\n        this.aggregateTimer = setTimeout(this._onTimeout, this.aggregateTimeout);\n      }\n\n      this.aggregatedChanges.delete(item);\n      this.aggregatedRemovals.add(item);\n    }\n  }, {\n    key: \"_onTimeout\",\n    value: function _onTimeout() {\n      this.aggregateTimer = undefined;\n      var changes = this.aggregatedChanges;\n      var removals = this.aggregatedRemovals;\n      this.aggregatedChanges = new Set();\n      this.aggregatedRemovals = new Set();\n      this.emit(\"aggregated\", changes, removals);\n    }\n  }]);\n\n  return Watchpack;\n}(EventEmitter);\n\nmodule.exports = Watchpack;","map":{"version":3,"sources":["E:/DW/wasai-cinema/node_modules/watchpack/lib/watchpack.js"],"names":["getWatcherManager","require","LinkResolver","EventEmitter","globToRegExp","watchEventSource","EMPTY_ARRAY","EMPTY_OPTIONS","addWatchersToSet","watchers","set","ww","w","watcher","has","directoryWatcher","add","stringToRegexp","ignored","source","globstar","extended","matchingStart","slice","length","ignoredToFunction","Array","isArray","regexp","RegExp","map","i","join","x","test","replace","Function","Error","normalizeOptions","options","followSymlinks","poll","normalizeCache","WeakMap","cachedNormalizeOptions","cacheEntry","get","undefined","normalized","WatchpackFileWatcher","watchpack","files","on","type","file","_missing","_onRemove","mtime","_onChange","close","WatchpackDirectoryWatcher","directories","item","Watchpack","aggregateTimeout","watcherOptions","watcherManager","fileWatchers","Map","directoryWatchers","Set","startTime","paused","aggregatedChanges","aggregatedRemovals","aggregateTimer","_onTimeout","bind","arg1","arg2","arg3","missing","filter","path","addToMap","key","list","push","fileWatchersNeeded","directoryWatchersNeeded","missingFiles","resolver","resolve","innerFile","dir","first","innerItem","needed","delete","update","batch","watchFile","watchDirectory","clearTimeout","values","clear","obj","Object","create","times","getTimes","keys","collectTimeInfoEntries","fileTimestamps","directoryTimestamps","allWatchers","safeTime","value","changes","removals","emit","setTimeout","module","exports"],"mappings":"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","sourcesContent":["/*\n\tMIT License http://www.opensource.org/licenses/mit-license.php\n\tAuthor Tobias Koppers @sokra\n*/\n\"use strict\";\n\nconst getWatcherManager = require(\"./getWatcherManager\");\nconst LinkResolver = require(\"./LinkResolver\");\nconst EventEmitter = require(\"events\").EventEmitter;\nconst globToRegExp = require(\"glob-to-regexp\");\nconst watchEventSource = require(\"./watchEventSource\");\n\nconst EMPTY_ARRAY = [];\nconst EMPTY_OPTIONS = {};\n\nfunction addWatchersToSet(watchers, set) {\n\tfor (const ww of watchers) {\n\t\tconst w = ww.watcher;\n\t\tif (!set.has(w.directoryWatcher)) {\n\t\t\tset.add(w.directoryWatcher);\n\t\t}\n\t}\n}\n\nconst stringToRegexp = ignored => {\n\tconst source = globToRegExp(ignored, { globstar: true, extended: true })\n\t\t.source;\n\tconst matchingStart = source.slice(0, source.length - 1) + \"(?:$|\\\\/)\";\n\treturn matchingStart;\n};\n\nconst ignoredToFunction = ignored => {\n\tif (Array.isArray(ignored)) {\n\t\tconst regexp = new RegExp(ignored.map(i => stringToRegexp(i)).join(\"|\"));\n\t\treturn x => regexp.test(x.replace(/\\\\/g, \"/\"));\n\t} else if (typeof ignored === \"string\") {\n\t\tconst regexp = new RegExp(stringToRegexp(ignored));\n\t\treturn x => regexp.test(x.replace(/\\\\/g, \"/\"));\n\t} else if (ignored instanceof RegExp) {\n\t\treturn x => ignored.test(x.replace(/\\\\/g, \"/\"));\n\t} else if (ignored instanceof Function) {\n\t\treturn ignored;\n\t} else if (ignored) {\n\t\tthrow new Error(`Invalid option for 'ignored': ${ignored}`);\n\t} else {\n\t\treturn () => false;\n\t}\n};\n\nconst normalizeOptions = options => {\n\treturn {\n\t\tfollowSymlinks: !!options.followSymlinks,\n\t\tignored: ignoredToFunction(options.ignored),\n\t\tpoll: options.poll\n\t};\n};\n\nconst normalizeCache = new WeakMap();\nconst cachedNormalizeOptions = options => {\n\tconst cacheEntry = normalizeCache.get(options);\n\tif (cacheEntry !== undefined) return cacheEntry;\n\tconst normalized = normalizeOptions(options);\n\tnormalizeCache.set(options, normalized);\n\treturn normalized;\n};\n\nclass WatchpackFileWatcher {\n\tconstructor(watchpack, watcher, files) {\n\t\tthis.files = Array.isArray(files) ? files : [files];\n\t\tthis.watcher = watcher;\n\t\twatcher.on(\"initial-missing\", type => {\n\t\t\tfor (const file of this.files) {\n\t\t\t\tif (!watchpack._missing.has(file))\n\t\t\t\t\twatchpack._onRemove(file, file, type);\n\t\t\t}\n\t\t});\n\t\twatcher.on(\"change\", (mtime, type) => {\n\t\t\tfor (const file of this.files) {\n\t\t\t\twatchpack._onChange(file, mtime, file, type);\n\t\t\t}\n\t\t});\n\t\twatcher.on(\"remove\", type => {\n\t\t\tfor (const file of this.files) {\n\t\t\t\twatchpack._onRemove(file, file, type);\n\t\t\t}\n\t\t});\n\t}\n\n\tupdate(files) {\n\t\tif (!Array.isArray(files)) {\n\t\t\tif (this.files.length !== 1) {\n\t\t\t\tthis.files = [files];\n\t\t\t} else if (this.files[0] !== files) {\n\t\t\t\tthis.files[0] = files;\n\t\t\t}\n\t\t} else {\n\t\t\tthis.files = files;\n\t\t}\n\t}\n\n\tclose() {\n\t\tthis.watcher.close();\n\t}\n}\n\nclass WatchpackDirectoryWatcher {\n\tconstructor(watchpack, watcher, directories) {\n\t\tthis.directories = Array.isArray(directories) ? directories : [directories];\n\t\tthis.watcher = watcher;\n\t\twatcher.on(\"initial-missing\", type => {\n\t\t\tfor (const item of this.directories) {\n\t\t\t\twatchpack._onRemove(item, item, type);\n\t\t\t}\n\t\t});\n\t\twatcher.on(\"change\", (file, mtime, type) => {\n\t\t\tfor (const item of this.directories) {\n\t\t\t\twatchpack._onChange(item, mtime, file, type);\n\t\t\t}\n\t\t});\n\t\twatcher.on(\"remove\", type => {\n\t\t\tfor (const item of this.directories) {\n\t\t\t\twatchpack._onRemove(item, item, type);\n\t\t\t}\n\t\t});\n\t}\n\n\tupdate(directories) {\n\t\tif (!Array.isArray(directories)) {\n\t\t\tif (this.directories.length !== 1) {\n\t\t\t\tthis.directories = [directories];\n\t\t\t} else if (this.directories[0] !== directories) {\n\t\t\t\tthis.directories[0] = directories;\n\t\t\t}\n\t\t} else {\n\t\t\tthis.directories = directories;\n\t\t}\n\t}\n\n\tclose() {\n\t\tthis.watcher.close();\n\t}\n}\n\nclass Watchpack extends EventEmitter {\n\tconstructor(options) {\n\t\tsuper();\n\t\tif (!options) options = EMPTY_OPTIONS;\n\t\tthis.options = options;\n\t\tthis.aggregateTimeout =\n\t\t\ttypeof options.aggregateTimeout === \"number\"\n\t\t\t\t? options.aggregateTimeout\n\t\t\t\t: 200;\n\t\tthis.watcherOptions = cachedNormalizeOptions(options);\n\t\tthis.watcherManager = getWatcherManager(this.watcherOptions);\n\t\tthis.fileWatchers = new Map();\n\t\tthis.directoryWatchers = new Map();\n\t\tthis._missing = new Set();\n\t\tthis.startTime = undefined;\n\t\tthis.paused = false;\n\t\tthis.aggregatedChanges = new Set();\n\t\tthis.aggregatedRemovals = new Set();\n\t\tthis.aggregateTimer = undefined;\n\t\tthis._onTimeout = this._onTimeout.bind(this);\n\t}\n\n\twatch(arg1, arg2, arg3) {\n\t\tlet files, directories, missing, startTime;\n\t\tif (!arg2) {\n\t\t\t({\n\t\t\t\tfiles = EMPTY_ARRAY,\n\t\t\t\tdirectories = EMPTY_ARRAY,\n\t\t\t\tmissing = EMPTY_ARRAY,\n\t\t\t\tstartTime\n\t\t\t} = arg1);\n\t\t} else {\n\t\t\tfiles = arg1;\n\t\t\tdirectories = arg2;\n\t\t\tmissing = EMPTY_ARRAY;\n\t\t\tstartTime = arg3;\n\t\t}\n\t\tthis.paused = false;\n\t\tconst fileWatchers = this.fileWatchers;\n\t\tconst directoryWatchers = this.directoryWatchers;\n\t\tconst ignored = this.watcherOptions.ignored;\n\t\tconst filter = path => !ignored(path);\n\t\tconst addToMap = (map, key, item) => {\n\t\t\tconst list = map.get(key);\n\t\t\tif (list === undefined) {\n\t\t\t\tmap.set(key, item);\n\t\t\t} else if (Array.isArray(list)) {\n\t\t\t\tlist.push(item);\n\t\t\t} else {\n\t\t\t\tmap.set(key, [list, item]);\n\t\t\t}\n\t\t};\n\t\tconst fileWatchersNeeded = new Map();\n\t\tconst directoryWatchersNeeded = new Map();\n\t\tconst missingFiles = new Set();\n\t\tif (this.watcherOptions.followSymlinks) {\n\t\t\tconst resolver = new LinkResolver();\n\t\t\tfor (const file of files) {\n\t\t\t\tif (filter(file)) {\n\t\t\t\t\tfor (const innerFile of resolver.resolve(file)) {\n\t\t\t\t\t\tif (file === innerFile || filter(innerFile)) {\n\t\t\t\t\t\t\taddToMap(fileWatchersNeeded, innerFile, file);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tfor (const file of missing) {\n\t\t\t\tif (filter(file)) {\n\t\t\t\t\tfor (const innerFile of resolver.resolve(file)) {\n\t\t\t\t\t\tif (file === innerFile || filter(innerFile)) {\n\t\t\t\t\t\t\tmissingFiles.add(file);\n\t\t\t\t\t\t\taddToMap(fileWatchersNeeded, innerFile, file);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tfor (const dir of directories) {\n\t\t\t\tif (filter(dir)) {\n\t\t\t\t\tlet first = true;\n\t\t\t\t\tfor (const innerItem of resolver.resolve(dir)) {\n\t\t\t\t\t\tif (filter(innerItem)) {\n\t\t\t\t\t\t\taddToMap(\n\t\t\t\t\t\t\t\tfirst ? directoryWatchersNeeded : fileWatchersNeeded,\n\t\t\t\t\t\t\t\tinnerItem,\n\t\t\t\t\t\t\t\tdir\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tfirst = false;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t} else {\n\t\t\tfor (const file of files) {\n\t\t\t\tif (filter(file)) {\n\t\t\t\t\taddToMap(fileWatchersNeeded, file, file);\n\t\t\t\t}\n\t\t\t}\n\t\t\tfor (const file of missing) {\n\t\t\t\tif (filter(file)) {\n\t\t\t\t\tmissingFiles.add(file);\n\t\t\t\t\taddToMap(fileWatchersNeeded, file, file);\n\t\t\t\t}\n\t\t\t}\n\t\t\tfor (const dir of directories) {\n\t\t\t\tif (filter(dir)) {\n\t\t\t\t\taddToMap(directoryWatchersNeeded, dir, dir);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t// Close unneeded old watchers\n\t\t// and update existing watchers\n\t\tfor (const [key, w] of fileWatchers) {\n\t\t\tconst needed = fileWatchersNeeded.get(key);\n\t\t\tif (needed === undefined) {\n\t\t\t\tw.close();\n\t\t\t\tfileWatchers.delete(key);\n\t\t\t} else {\n\t\t\t\tw.update(needed);\n\t\t\t\tfileWatchersNeeded.delete(key);\n\t\t\t}\n\t\t}\n\t\tfor (const [key, w] of directoryWatchers) {\n\t\t\tconst needed = directoryWatchersNeeded.get(key);\n\t\t\tif (needed === undefined) {\n\t\t\t\tw.close();\n\t\t\t\tdirectoryWatchers.delete(key);\n\t\t\t} else {\n\t\t\t\tw.update(needed);\n\t\t\t\tdirectoryWatchersNeeded.delete(key);\n\t\t\t}\n\t\t}\n\t\t// Create new watchers and install handlers on these watchers\n\t\twatchEventSource.batch(() => {\n\t\t\tfor (const [key, files] of fileWatchersNeeded) {\n\t\t\t\tconst watcher = this.watcherManager.watchFile(key, startTime);\n\t\t\t\tif (watcher) {\n\t\t\t\t\tfileWatchers.set(key, new WatchpackFileWatcher(this, watcher, files));\n\t\t\t\t}\n\t\t\t}\n\t\t\tfor (const [key, directories] of directoryWatchersNeeded) {\n\t\t\t\tconst watcher = this.watcherManager.watchDirectory(key, startTime);\n\t\t\t\tif (watcher) {\n\t\t\t\t\tdirectoryWatchers.set(\n\t\t\t\t\t\tkey,\n\t\t\t\t\t\tnew WatchpackDirectoryWatcher(this, watcher, directories)\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t\tthis._missing = missingFiles;\n\t\tthis.startTime = startTime;\n\t}\n\n\tclose() {\n\t\tthis.paused = true;\n\t\tif (this.aggregateTimer) clearTimeout(this.aggregateTimer);\n\t\tfor (const w of this.fileWatchers.values()) w.close();\n\t\tfor (const w of this.directoryWatchers.values()) w.close();\n\t\tthis.fileWatchers.clear();\n\t\tthis.directoryWatchers.clear();\n\t}\n\n\tpause() {\n\t\tthis.paused = true;\n\t\tif (this.aggregateTimer) clearTimeout(this.aggregateTimer);\n\t}\n\n\tgetTimes() {\n\t\tconst directoryWatchers = new Set();\n\t\taddWatchersToSet(this.fileWatchers.values(), directoryWatchers);\n\t\taddWatchersToSet(this.directoryWatchers.values(), directoryWatchers);\n\t\tconst obj = Object.create(null);\n\t\tfor (const w of directoryWatchers) {\n\t\t\tconst times = w.getTimes();\n\t\t\tfor (const file of Object.keys(times)) obj[file] = times[file];\n\t\t}\n\t\treturn obj;\n\t}\n\n\tgetTimeInfoEntries() {\n\t\tconst map = new Map();\n\t\tthis.collectTimeInfoEntries(map, map);\n\t\treturn map;\n\t}\n\n\tcollectTimeInfoEntries(fileTimestamps, directoryTimestamps) {\n\t\tconst allWatchers = new Set();\n\t\taddWatchersToSet(this.fileWatchers.values(), allWatchers);\n\t\taddWatchersToSet(this.directoryWatchers.values(), allWatchers);\n\t\tconst safeTime = { value: 0 };\n\t\tfor (const w of allWatchers) {\n\t\t\tw.collectTimeInfoEntries(fileTimestamps, directoryTimestamps, safeTime);\n\t\t}\n\t}\n\n\tgetAggregated() {\n\t\tif (this.aggregateTimer) {\n\t\t\tclearTimeout(this.aggregateTimer);\n\t\t\tthis.aggregateTimer = undefined;\n\t\t}\n\t\tconst changes = this.aggregatedChanges;\n\t\tconst removals = this.aggregatedRemovals;\n\t\tthis.aggregatedChanges = new Set();\n\t\tthis.aggregatedRemovals = new Set();\n\t\treturn { changes, removals };\n\t}\n\n\t_onChange(item, mtime, file, type) {\n\t\tfile = file || item;\n\t\tif (!this.paused) {\n\t\t\tthis.emit(\"change\", file, mtime, type);\n\t\t\tif (this.aggregateTimer) clearTimeout(this.aggregateTimer);\n\t\t\tthis.aggregateTimer = setTimeout(this._onTimeout, this.aggregateTimeout);\n\t\t}\n\t\tthis.aggregatedRemovals.delete(item);\n\t\tthis.aggregatedChanges.add(item);\n\t}\n\n\t_onRemove(item, file, type) {\n\t\tfile = file || item;\n\t\tif (!this.paused) {\n\t\t\tthis.emit(\"remove\", file, type);\n\t\t\tif (this.aggregateTimer) clearTimeout(this.aggregateTimer);\n\t\t\tthis.aggregateTimer = setTimeout(this._onTimeout, this.aggregateTimeout);\n\t\t}\n\t\tthis.aggregatedChanges.delete(item);\n\t\tthis.aggregatedRemovals.add(item);\n\t}\n\n\t_onTimeout() {\n\t\tthis.aggregateTimer = undefined;\n\t\tconst changes = this.aggregatedChanges;\n\t\tconst removals = this.aggregatedRemovals;\n\t\tthis.aggregatedChanges = new Set();\n\t\tthis.aggregatedRemovals = new Set();\n\t\tthis.emit(\"aggregated\", changes, removals);\n\t}\n}\n\nmodule.exports = Watchpack;\n"]},"metadata":{},"sourceType":"script"}