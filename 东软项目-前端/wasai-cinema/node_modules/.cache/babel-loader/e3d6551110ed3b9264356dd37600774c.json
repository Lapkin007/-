{"ast":null,"code":"//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport { QueryFilmList, QueryFilmComment, PostFilmComment } from \"@/api/film\";\nexport default {\n  data: function data() {\n    return {\n      //电影信息\n      movie_info: [],\n      //评论信息\n      comment: [],\n      rate_visible: false,\n      //评分表单\n      form_comment: {\n        comment: \"\",\n        star: 0,\n        fid: \"\",\n        uid: \"\"\n      },\n      value: 3,\n      //通过网址fid传参数到电影主键\n      Film_id: this.$route.query.fid\n    };\n  },\n  methods: {\n    //电影详细信息\n    QueryMovieinfo: function QueryMovieinfo() {\n      var _this = this;\n\n      QueryFilmList().then(function (res) {\n        if (res.code == 200) {\n          for (var i = 0; i < res.data.length; i++) {\n            if (_this.Film_id == res.data[i].id) {\n              _this.movie_info = res.data[i];\n            }\n          }\n        }\n      });\n    },\n    //点击购票\n    ClickTicket: function ClickTicket() {\n      this.$router.push(\"/ticket?fid=\" + this.Film_id);\n    },\n    //点击评论\n    ClickPostComment: function ClickPostComment() {\n      var _this2 = this;\n\n      this.form_comment.fid = this.Film_id;\n      this.form_comment.uid = localStorage.getItem(\"uid\");\n      var PostComment = this.form_comment;\n      PostFilmComment(PostComment).then(function (res) {\n        if (res.code == 200) {\n          _this2.$message({\n            message: \"评论成功\",\n            type: \"success\"\n          });\n\n          _this2.rate_visible = false;\n        } else {\n          _this2.$message({\n            message: \"评论失败\",\n            type: \"warning\"\n          });\n        }\n      });\n    },\n    //电影评论信息\n    QueryMovieFE: function QueryMovieFE() {\n      var _this3 = this;\n\n      QueryFilmComment().then(function (res) {\n        if (res.code == 200) {\n          _this3.comment = res.data;\n          console.log(\"以下是电影评论表\");\n          console.log(_this3.comment);\n        }\n      });\n    },\n    //小功能\n    load: function load() {\n      this.count += 2;\n    },\n    isLogin: function isLogin(a) {\n      var _this4 = this;\n\n      if (localStorage.getItem(\"uid\") == null) {\n        this.$confirm(\"未检测到登录\", \"提示\", {\n          confirmButtonText: \"去登陆\",\n          cancelButtonText: \"取消\",\n          type: \"warning\"\n        }).then(function () {\n          _this4.$router.push(\"/login\");\n        });\n      }\n    }\n  },\n  mounted: function mounted() {\n    //查询电影列表并添加到movie_info列表\n    this.QueryMovieinfo(); //查询电影评论并添加到movie_comment列表\n\n    this.QueryMovieFE();\n  }\n};","map":{"version":3,"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA2IA;AACA;AACAA,MADA,kBACA;AACA;AACA;AACAC,oBAFA;AAGA;AACAC,iBAJA;AAKAC,yBALA;AAMA;AACAC;AAAAF;AAAAG;AAAAC;AAAAC;AAAA,OAPA;AAQAC,cARA;AASA;AACAC;AAVA;AAYA,GAdA;AAeAC;AACA;AACAC,kBAFA,4BAEA;AAAA;;AACAC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OARA;AASA,KAZA;AAaA;AACAC,eAdA,yBAcA;AACA;AACA,KAhBA;AAiBA;AACAC,oBAlBA,8BAkBA;AAAA;;AACA;AACA;AACA;AACAC;AACA;AACA;AAAAC;AAAAC;AAAA;;AACA;AACA,SAHA,MAGA;AACA;AAAAD;AAAAC;AAAA;AACA;AACA,OAPA;AAQA,KA9BA;AA+BA;AACAC,gBAhCA,0BAgCA;AAAA;;AACAC;AACA;AACA;AACAC;AACAA;AACA;AACA,OANA;AAOA,KAxCA;AA0CA;AACAC,QA3CA,kBA2CA;AACA;AACA,KA7CA;AA8CAC,WA9CA,mBA8CAC,CA9CA,EA8CA;AAAA;;AACA;AACA;AACAC,kCADA;AAEAC,gCAFA;AAGAR;AAHA,WAIAS,IAJA,CAIA;AACA;AACA,SANA;AAOA;AACA;AAxDA,GAfA;AAyEAC;AACA;AACA,0BAFA,CAGA;;AACA;AACA;AA9EA","names":["data","movie_info","comment","rate_visible","form_comment","star","fid","uid","value","Film_id","methods","QueryMovieinfo","QueryFilmList","ClickTicket","ClickPostComment","PostFilmComment","message","type","QueryMovieFE","QueryFilmComment","console","load","isLogin","a","confirmButtonText","cancelButtonText","then","mounted"],"sourceRoot":"src/views","sources":["film_detail.vue"],"sourcesContent":["<template>\r\n  <div class=\"all\">\r\n    <el-container>\r\n      <!-- 上半 -->\r\n      <!-- 上方电影图片及按钮 -->\r\n      <el-header>\r\n        <div class=\"film_info\">\r\n          <img\r\n            style=\"width: 240px; height: 350px; float: left\"\r\n            :src=\"movie_info.cover\"\r\n            alt=\"error\"\r\n          />\r\n          <div class=\"film_detail_info_box\">\r\n            <h2 class=\"film_detail_name\" style=\"overflow: hidden\">\r\n              {{ movie_info.name }}\r\n            </h2>\r\n            <el-rate\r\n              v-model=\"movie_info.hot\"\r\n              disabled\r\n              show-score\r\n              text-color=\"#ff9900\"\r\n              score-template=\"{value}\"\r\n              class=\"rate\"\r\n            ></el-rate>\r\n            <span class=\"info_text1\"\r\n              >电影类型：&nbsp; {{ movie_info.type }}</span\r\n            >\r\n            <span class=\"info_text1\"\r\n              >地区:&nbsp;{{ movie_info.region }}/时长:&nbsp;{{\r\n                movie_info.duration\r\n              }}\r\n            </span>\r\n            <span class=\"info_text1\"\r\n              >上映日期：&nbsp;{{ movie_info.releaseTime }}\r\n            </span>\r\n            <!-- 购票按钮 -->\r\n\r\n            <el-button class=\"btn\" @click=\"ClickTicket()\">特惠购票</el-button>\r\n            <!-- 评分按钮 -->\r\n            <el-button\r\n              class=\"btn\"\r\n              @click=\"\r\n                rate_visible = true;\r\n                isLogin();\r\n              \"\r\n              >评分</el-button\r\n            >\r\n            <el-dialog\r\n              title=\"电影评分\"\r\n              :visible.sync=\"rate_visible\"\r\n              width=\"50%\"\r\n            >\r\n              <el-form :model=\"form_comment\">\r\n                <el-form-item label=\"\">\r\n                  <el-rate\r\n                    v-model=\"form_comment.star\"\r\n                    show-score\r\n                    text-color=\"#ff9900\"\r\n                  ></el-rate>\r\n                </el-form-item>\r\n                <el-form-item label=\"\">\r\n                  <el-input\r\n                    v-model=\"form_comment.comment\"\r\n                    autocomplete=\"off\"\r\n                    type=\"textarea\"\r\n                    maxlength=\"20\"\r\n                    show-word-limit\r\n                    :autosize=\"{ minRows: 10, maxRows: 10 }\"\r\n                    placeholder=\"请输入内容\"\r\n                  ></el-input>\r\n                </el-form-item>\r\n              </el-form>\r\n              <span slot=\"footer\" class=\"dialog-footer\">\r\n                <el-button @click=\"rate_visible = false\">取 消</el-button>\r\n                <el-button type=\"primary\" @click=\"ClickPostComment()\"\r\n                  >确认提交</el-button\r\n                >\r\n              </span>\r\n            </el-dialog>\r\n          </div>\r\n        </div>\r\n      </el-header>\r\n      <!-- 上半结束 -->\r\n\r\n      <!-- 间幕不要动 -->\r\n      <el-link\r\n        icon=\"el-icon-back\"\r\n        href=\"/\"\r\n        :underline=\"false\"\r\n        class=\"middle_ellink\"\r\n        >返回</el-link\r\n      >\r\n      <span class=\"middle_span\">详情页面</span>\r\n      <!-- 间幕结束 -->\r\n\r\n      <!-- 下半 -->\r\n      <el-main>\r\n        <h1 class=\"title\">剧情简介</h1>\r\n\r\n        <!-- 剧情简介 -->\r\n        <p class=\"shortdesc\">{{ movie_info.introduction }}</p>\r\n        <!-- 剧情简介结束 -->\r\n\r\n        <h1 style=\"text-align: left; color: black\">电影评论</h1>\r\n\r\n        <!-- 电影评论 -->\r\n        <ul\r\n          class=\"movie_comment_box\"\r\n          v-infinite-scroll=\"load\"\r\n          style=\"overflow: auto\"\r\n        >\r\n          <li v-for=\"(item, index) in comment\" :key=\"index\">\r\n            <img :src=\"item.user.avatar\" class=\"movie_comment_img\" />\r\n            <span class=\"movie_comment_span1\">{{ item.user.nickname }}</span>\r\n            <el-rate\r\n              v-model=\"item.filmEvaluate.star\"\r\n              disabled\r\n              show-score\r\n              text-color=\"#ff9900\"\r\n              score-template=\"{value}\"\r\n              class=\"movie_comment_rate\"\r\n            ></el-rate\r\n            ><br />\r\n            <span class=\"movie_comment_span2\">{{\r\n              item.filmEvaluate.comment\r\n            }}</span>\r\n            <span class=\"movie_comment_span3\">{{\r\n              item.filmEvaluate.createAt\r\n            }}</span>\r\n          </li>\r\n        </ul>\r\n        <!-- 电影评论结束 -->\r\n      </el-main>\r\n      <!-- 下半结束 -->\r\n    </el-container>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { QueryFilmList, QueryFilmComment, PostFilmComment } from \"@/api/film\";\r\nexport default {\r\n  data() {\r\n    return {\r\n      //电影信息\r\n      movie_info: [],\r\n      //评论信息\r\n      comment: [],\r\n      rate_visible: false,\r\n      //评分表单\r\n      form_comment: { comment: \"\", star: 0, fid: \"\", uid: \"\" },\r\n      value: 3,\r\n      //通过网址fid传参数到电影主键\r\n      Film_id: this.$route.query.fid,\r\n    };\r\n  },\r\n  methods: {\r\n    //电影详细信息\r\n    QueryMovieinfo() {\r\n      QueryFilmList().then((res) => {\r\n        if (res.code == 200) {\r\n          for (var i = 0; i < res.data.length; i++) {\r\n            if (this.Film_id == res.data[i].id) {\r\n              this.movie_info = res.data[i];\r\n            }\r\n          }\r\n        }\r\n      });\r\n    },\r\n    //点击购票\r\n    ClickTicket() {\r\n      this.$router.push(\"/ticket?fid=\" + this.Film_id);\r\n    },\r\n    //点击评论\r\n    ClickPostComment() {\r\n      this.form_comment.fid = this.Film_id;\r\n      this.form_comment.uid = localStorage.getItem(\"uid\");\r\n      const PostComment = this.form_comment;\r\n      PostFilmComment(PostComment).then((res) => {\r\n        if (res.code == 200) {\r\n          this.$message({ message: \"评论成功\", type: \"success\" });\r\n          this.rate_visible = false;\r\n        } else {\r\n          this.$message({ message: \"评论失败\", type: \"warning\" });\r\n        }\r\n      });\r\n    },\r\n    //电影评论信息\r\n    QueryMovieFE() {\r\n      QueryFilmComment().then((res) => {\r\n        if (res.code == 200) {\r\n          this.comment=res.data;\r\n          console.log(\"以下是电影评论表\")\r\n          console.log(this.comment);\r\n        }\r\n      });\r\n    },\r\n\r\n    //小功能\r\n    load() {\r\n      this.count += 2;\r\n    },\r\n    isLogin(a) {\r\n      if (localStorage.getItem(\"uid\") == null) {\r\n        this.$confirm(\"未检测到登录\", \"提示\", {\r\n          confirmButtonText: \"去登陆\",\r\n          cancelButtonText: \"取消\",\r\n          type: \"warning\",\r\n        }).then(() => {\r\n          this.$router.push(\"/login\");\r\n        });\r\n      }\r\n    },\r\n  },\r\n  mounted: function () {\r\n    //查询电影列表并添加到movie_info列表\r\n    this.QueryMovieinfo();\r\n    //查询电影评论并添加到movie_comment列表\r\n    this.QueryMovieFE();\r\n  },\r\n};\r\n</script>\r\n\r\n<style scoped>\r\n/* 全局及header和main设置 */\r\n.all {\r\n  width: 100%;\r\n  height: 100%;\r\n  text-align: center;\r\n}\r\n.el-header {\r\n  background-color: rgb(78, 89, 241);\r\n  color: honeydew;\r\n  min-height: 100px;\r\n  width: 1400px;\r\n  margin: 0 auto;\r\n  max-height: 350px;\r\n  min-height: 350px;\r\n}\r\n.el-main {\r\n  margin: 0 auto;\r\n  /* background-color: blueviolet; */\r\n  color: honeydew;\r\n  width: 1100px;\r\n  max-height: 400px;\r\n  min-height: 400px;\r\n  overflow: auto;\r\n}\r\n/* 上方电影图片及按钮CSS */\r\n.film_info {\r\n  width: 1100px;\r\n  height: 400px;\r\n  /* background-color: rgb(90, 155, 117); */\r\n  position: relative;\r\n  margin: 50px auto;\r\n}\r\n.film_detail_name {\r\n  display: inline-block;\r\n  float: left;\r\n  font-size: 30px;\r\n  color: white;\r\n  width: 300px;\r\n  /* background-color: brown; */\r\n  text-align: left;\r\n  height: 143px;\r\n  line-height: 50px;\r\n  margin: -3px;\r\n}\r\n.film_detail_info_box {\r\n  float: left;\r\n  margin-left: 60px;\r\n  position: relative;\r\n  /* background-color: blue; */\r\n  height: 400px;\r\n  width: 500px;\r\n}\r\n.rate {\r\n  display: inline-block;\r\n  /* background-color: aqua; */\r\n  height: 100px;\r\n  margin-top: 40px;\r\n  width: 200px;\r\n  text-align: left;\r\n}\r\n.info_text1 {\r\n  height: 30px;\r\n  line-height: 30px;\r\n  /* background-color: aqua; */\r\n  display: block;\r\n  text-align: left;\r\n}\r\n.btn {\r\n  margin-top: 15px;\r\n  background-color: rgb(243, 77, 77);\r\n  border: none;\r\n  color: white;\r\n  float: left;\r\n  width: 100px;\r\n  margin-right: 20px;\r\n  font-size: 13px;\r\n}\r\n.el-rate__text {\r\n  margin-top: -5px !important ;\r\n}\r\n/* 间幕 */\r\n.middle_span {\r\n  display: inline-block;\r\n  text-align: left;\r\n  width: 90px;\r\n  margin-left: 380px;\r\n  margin-top: 10px;\r\n  font-size: 20px;\r\n  color: black;\r\n}\r\n.middle_ellink {\r\n  margin-bottom: 10px;\r\n  display: block;\r\n  font-size: 16px;\r\n  width: 100px;\r\n  margin-left: 350px;\r\n  margin-top: 60px;\r\n}\r\n/* 剧情简介及标题 */\r\n.shortdesc {\r\n  text-indent: 30px;\r\n  text-align: left;\r\n  color: black;\r\n}\r\n.title {\r\n  text-align: left;\r\n  color: black;\r\n}\r\n/* 电影评论CSS */\r\n.movie_comment_box {\r\n  list-style-type: none;\r\n  margin: 0;\r\n  padding: 0;\r\n}\r\n.movie_comment_box li {\r\n  text-align: left;\r\n  height: 80px;\r\n  margin-bottom: 20px;\r\n}\r\n.movie_comment_box li img {\r\n  width: 60px;\r\n  height: 60px;\r\n  border: 1px solid gray;\r\n  border-radius: 60px;\r\n}\r\n.movie_comment_img {\r\n  display: inline-block;\r\n  float: left;\r\n}\r\n.movie_comment_span1 {\r\n  display: inline-block;\r\n  float: left;\r\n  margin-left: 20px;\r\n  color: black;\r\n  width: 100px;\r\n}\r\n.movie_comment_rate {\r\n  display: inline-block;\r\n  height: 100px;\r\n  margin-top: 40px;\r\n  width: 200px;\r\n  text-align: left;\r\n  height: 30px;\r\n  margin: 0;\r\n  margin-left: 50px;\r\n}\r\n.movie_comment_span2 {\r\n  font-size: 20px;\r\n  margin-left: 50px;\r\n  color: gray;\r\n}\r\n.movie_comment_span3 {\r\n  float: right;\r\n  color: gray;\r\n}\r\n</style>"]},"metadata":{},"sourceType":"module"}