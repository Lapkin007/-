{"ast":null,"code":"\"use strict\";\n\nvar _objectSpread = require(\"E:/DW/wasai-cinema/node_modules/@babel/runtime/helpers/objectSpread2.js\").default;\n\nvar _classCallCheck = require(\"E:/DW/wasai-cinema/node_modules/@babel/runtime/helpers/classCallCheck.js\").default;\n\nvar _createClass = require(\"E:/DW/wasai-cinema/node_modules/@babel/runtime/helpers/createClass.js\").default;\n\nvar _createForOfIteratorHelper = require(\"E:/DW/wasai-cinema/node_modules/@babel/runtime/helpers/createForOfIteratorHelper.js\").default;\n\nvar _typeof = require(\"E:/DW/wasai-cinema/node_modules/@babel/runtime/helpers/typeof.js\").default;\n\nvar _taggedTemplateLiteral = require(\"E:/DW/wasai-cinema/node_modules/@babel/runtime/helpers/taggedTemplateLiteral.js\").default;\n\nvar _templateObject, _templateObject2, _templateObject3, _templateObject4, _templateObject5, _templateObject6, _templateObject7, _templateObject8, _templateObject9, _templateObject10, _templateObject11, _templateObject12, _templateObject13, _templateObject14, _templateObject15, _templateObject16, _templateObject17, _templateObject18, _templateObject19, _templateObject20, _templateObject21, _templateObject22, _templateObject23, _templateObject24, _templateObject25, _templateObject26, _templateObject27, _templateObject28, _templateObject29, _templateObject30, _templateObject31, _templateObject32, _templateObject33, _templateObject34, _templateObject35, _templateObject36, _templateObject37, _templateObject38, _templateObject39;\n\nrequire(\"core-js/modules/es.error.cause.js\");\n\nrequire(\"core-js/modules/es.object.to-string.js\");\n\nrequire(\"core-js/modules/web.dom-collections.for-each.js\");\n\nrequire(\"core-js/modules/es.array.concat.js\");\n\nrequire(\"core-js/modules/es.array.join.js\");\n\nrequire(\"core-js/modules/es.array.filter.js\");\n\nrequire(\"core-js/modules/es.array.includes.js\");\n\nrequire(\"core-js/modules/es.string.includes.js\");\n\nrequire(\"core-js/modules/es.json.stringify.js\");\n\nrequire(\"core-js/modules/es.regexp.exec.js\");\n\nrequire(\"core-js/modules/es.regexp.test.js\");\n\nrequire(\"core-js/modules/es.string.split.js\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.getData = exports.KeywordCxt = exports.validateFunctionCode = void 0;\n\nvar boolSchema_1 = require(\"./boolSchema\");\n\nvar dataType_1 = require(\"./dataType\");\n\nvar applicability_1 = require(\"./applicability\");\n\nvar dataType_2 = require(\"./dataType\");\n\nvar defaults_1 = require(\"./defaults\");\n\nvar keyword_1 = require(\"./keyword\");\n\nvar subschema_1 = require(\"./subschema\");\n\nvar codegen_1 = require(\"../codegen\");\n\nvar names_1 = require(\"../names\");\n\nvar resolve_1 = require(\"../resolve\");\n\nvar util_1 = require(\"../util\");\n\nvar errors_1 = require(\"../errors\"); // schema compilation - generates validation function, subschemaCode (below) is used for subschemas\n\n\nfunction validateFunctionCode(it) {\n  if (isSchemaObj(it)) {\n    checkKeywords(it);\n\n    if (schemaCxtHasRules(it)) {\n      topSchemaObjCode(it);\n      return;\n    }\n  }\n\n  validateFunction(it, function () {\n    return (0, boolSchema_1.topBoolOrEmptySchema)(it);\n  });\n}\n\nexports.validateFunctionCode = validateFunctionCode;\n\nfunction validateFunction(_ref, body) {\n  var gen = _ref.gen,\n      validateName = _ref.validateName,\n      schema = _ref.schema,\n      schemaEnv = _ref.schemaEnv,\n      opts = _ref.opts;\n\n  if (opts.code.es5) {\n    gen.func(validateName, (0, codegen_1._)(_templateObject || (_templateObject = _taggedTemplateLiteral([\"\", \", \", \"\"])), names_1.default.data, names_1.default.valCxt), schemaEnv.$async, function () {\n      gen.code((0, codegen_1._)(_templateObject2 || (_templateObject2 = _taggedTemplateLiteral([\"\\\"use strict\\\"; \", \"\"])), funcSourceUrl(schema, opts)));\n      destructureValCxtES5(gen, opts);\n      gen.code(body);\n    });\n  } else {\n    gen.func(validateName, (0, codegen_1._)(_templateObject3 || (_templateObject3 = _taggedTemplateLiteral([\"\", \", \", \"\"])), names_1.default.data, destructureValCxt(opts)), schemaEnv.$async, function () {\n      return gen.code(funcSourceUrl(schema, opts)).code(body);\n    });\n  }\n}\n\nfunction destructureValCxt(opts) {\n  return (0, codegen_1._)(_templateObject4 || (_templateObject4 = _taggedTemplateLiteral([\"{\", \"=\\\"\\\", \", \", \", \", \", \"=\", \"\", \"}={}\"])), names_1.default.instancePath, names_1.default.parentData, names_1.default.parentDataProperty, names_1.default.rootData, names_1.default.data, opts.dynamicRef ? (0, codegen_1._)(_templateObject5 || (_templateObject5 = _taggedTemplateLiteral([\", \", \"={}\"])), names_1.default.dynamicAnchors) : codegen_1.nil);\n}\n\nfunction destructureValCxtES5(gen, opts) {\n  gen.if(names_1.default.valCxt, function () {\n    gen.var(names_1.default.instancePath, (0, codegen_1._)(_templateObject6 || (_templateObject6 = _taggedTemplateLiteral([\"\", \".\", \"\"])), names_1.default.valCxt, names_1.default.instancePath));\n    gen.var(names_1.default.parentData, (0, codegen_1._)(_templateObject7 || (_templateObject7 = _taggedTemplateLiteral([\"\", \".\", \"\"])), names_1.default.valCxt, names_1.default.parentData));\n    gen.var(names_1.default.parentDataProperty, (0, codegen_1._)(_templateObject8 || (_templateObject8 = _taggedTemplateLiteral([\"\", \".\", \"\"])), names_1.default.valCxt, names_1.default.parentDataProperty));\n    gen.var(names_1.default.rootData, (0, codegen_1._)(_templateObject9 || (_templateObject9 = _taggedTemplateLiteral([\"\", \".\", \"\"])), names_1.default.valCxt, names_1.default.rootData));\n    if (opts.dynamicRef) gen.var(names_1.default.dynamicAnchors, (0, codegen_1._)(_templateObject10 || (_templateObject10 = _taggedTemplateLiteral([\"\", \".\", \"\"])), names_1.default.valCxt, names_1.default.dynamicAnchors));\n  }, function () {\n    gen.var(names_1.default.instancePath, (0, codegen_1._)(_templateObject11 || (_templateObject11 = _taggedTemplateLiteral([\"\\\"\\\"\"]))));\n    gen.var(names_1.default.parentData, (0, codegen_1._)(_templateObject12 || (_templateObject12 = _taggedTemplateLiteral([\"undefined\"]))));\n    gen.var(names_1.default.parentDataProperty, (0, codegen_1._)(_templateObject13 || (_templateObject13 = _taggedTemplateLiteral([\"undefined\"]))));\n    gen.var(names_1.default.rootData, names_1.default.data);\n    if (opts.dynamicRef) gen.var(names_1.default.dynamicAnchors, (0, codegen_1._)(_templateObject14 || (_templateObject14 = _taggedTemplateLiteral([\"{}\"]))));\n  });\n}\n\nfunction topSchemaObjCode(it) {\n  var schema = it.schema,\n      opts = it.opts,\n      gen = it.gen;\n  validateFunction(it, function () {\n    if (opts.$comment && schema.$comment) commentKeyword(it);\n    checkNoDefault(it);\n    gen.let(names_1.default.vErrors, null);\n    gen.let(names_1.default.errors, 0);\n    if (opts.unevaluated) resetEvaluated(it);\n    typeAndKeywords(it);\n    returnResults(it);\n  });\n  return;\n}\n\nfunction resetEvaluated(it) {\n  // TODO maybe some hook to execute it in the end to check whether props/items are Name, as in assignEvaluated\n  var gen = it.gen,\n      validateName = it.validateName;\n  it.evaluated = gen.const(\"evaluated\", (0, codegen_1._)(_templateObject15 || (_templateObject15 = _taggedTemplateLiteral([\"\", \".evaluated\"])), validateName));\n  gen.if((0, codegen_1._)(_templateObject16 || (_templateObject16 = _taggedTemplateLiteral([\"\", \".dynamicProps\"])), it.evaluated), function () {\n    return gen.assign((0, codegen_1._)(_templateObject17 || (_templateObject17 = _taggedTemplateLiteral([\"\", \".props\"])), it.evaluated), (0, codegen_1._)(_templateObject18 || (_templateObject18 = _taggedTemplateLiteral([\"undefined\"]))));\n  });\n  gen.if((0, codegen_1._)(_templateObject19 || (_templateObject19 = _taggedTemplateLiteral([\"\", \".dynamicItems\"])), it.evaluated), function () {\n    return gen.assign((0, codegen_1._)(_templateObject20 || (_templateObject20 = _taggedTemplateLiteral([\"\", \".items\"])), it.evaluated), (0, codegen_1._)(_templateObject21 || (_templateObject21 = _taggedTemplateLiteral([\"undefined\"]))));\n  });\n}\n\nfunction funcSourceUrl(schema, opts) {\n  var schId = _typeof(schema) == \"object\" && schema[opts.schemaId];\n  return schId && (opts.code.source || opts.code.process) ? (0, codegen_1._)(_templateObject22 || (_templateObject22 = _taggedTemplateLiteral([\"/*# sourceURL=\", \" */\"])), schId) : codegen_1.nil;\n} // schema compilation - this function is used recursively to generate code for sub-schemas\n\n\nfunction subschemaCode(it, valid) {\n  if (isSchemaObj(it)) {\n    checkKeywords(it);\n\n    if (schemaCxtHasRules(it)) {\n      subSchemaObjCode(it, valid);\n      return;\n    }\n  }\n\n  (0, boolSchema_1.boolOrEmptySchema)(it, valid);\n}\n\nfunction schemaCxtHasRules(_ref2) {\n  var schema = _ref2.schema,\n      self = _ref2.self;\n  if (typeof schema == \"boolean\") return !schema;\n\n  for (var key in schema) {\n    if (self.RULES.all[key]) return true;\n  }\n\n  return false;\n}\n\nfunction isSchemaObj(it) {\n  return typeof it.schema != \"boolean\";\n}\n\nfunction subSchemaObjCode(it, valid) {\n  var schema = it.schema,\n      gen = it.gen,\n      opts = it.opts;\n  if (opts.$comment && schema.$comment) commentKeyword(it);\n  updateContext(it);\n  checkAsyncSchema(it);\n  var errsCount = gen.const(\"_errs\", names_1.default.errors);\n  typeAndKeywords(it, errsCount); // TODO var\n\n  gen.var(valid, (0, codegen_1._)(_templateObject23 || (_templateObject23 = _taggedTemplateLiteral([\"\", \" === \", \"\"])), errsCount, names_1.default.errors));\n}\n\nfunction checkKeywords(it) {\n  (0, util_1.checkUnknownRules)(it);\n  checkRefsAndKeywords(it);\n}\n\nfunction typeAndKeywords(it, errsCount) {\n  if (it.opts.jtd) return schemaKeywords(it, [], false, errsCount);\n  var types = (0, dataType_1.getSchemaTypes)(it.schema);\n  var checkedTypes = (0, dataType_1.coerceAndCheckDataType)(it, types);\n  schemaKeywords(it, types, !checkedTypes, errsCount);\n}\n\nfunction checkRefsAndKeywords(it) {\n  var schema = it.schema,\n      errSchemaPath = it.errSchemaPath,\n      opts = it.opts,\n      self = it.self;\n\n  if (schema.$ref && opts.ignoreKeywordsWithRef && (0, util_1.schemaHasRulesButRef)(schema, self.RULES)) {\n    self.logger.warn(\"$ref: keywords ignored in schema at path \\\"\".concat(errSchemaPath, \"\\\"\"));\n  }\n}\n\nfunction checkNoDefault(it) {\n  var schema = it.schema,\n      opts = it.opts;\n\n  if (schema.default !== undefined && opts.useDefaults && opts.strictSchema) {\n    (0, util_1.checkStrictMode)(it, \"default is ignored in the schema root\");\n  }\n}\n\nfunction updateContext(it) {\n  var schId = it.schema[it.opts.schemaId];\n  if (schId) it.baseId = (0, resolve_1.resolveUrl)(it.opts.uriResolver, it.baseId, schId);\n}\n\nfunction checkAsyncSchema(it) {\n  if (it.schema.$async && !it.schemaEnv.$async) throw new Error(\"async schema in sync schema\");\n}\n\nfunction commentKeyword(_ref3) {\n  var gen = _ref3.gen,\n      schemaEnv = _ref3.schemaEnv,\n      schema = _ref3.schema,\n      errSchemaPath = _ref3.errSchemaPath,\n      opts = _ref3.opts;\n  var msg = schema.$comment;\n\n  if (opts.$comment === true) {\n    gen.code((0, codegen_1._)(_templateObject24 || (_templateObject24 = _taggedTemplateLiteral([\"\", \".logger.log(\", \")\"])), names_1.default.self, msg));\n  } else if (typeof opts.$comment == \"function\") {\n    var schemaPath = (0, codegen_1.str)(_templateObject25 || (_templateObject25 = _taggedTemplateLiteral([\"\", \"/$comment\"])), errSchemaPath);\n    var rootName = gen.scopeValue(\"root\", {\n      ref: schemaEnv.root\n    });\n    gen.code((0, codegen_1._)(_templateObject26 || (_templateObject26 = _taggedTemplateLiteral([\"\", \".opts.$comment(\", \", \", \", \", \".schema)\"])), names_1.default.self, msg, schemaPath, rootName));\n  }\n}\n\nfunction returnResults(it) {\n  var gen = it.gen,\n      schemaEnv = it.schemaEnv,\n      validateName = it.validateName,\n      ValidationError = it.ValidationError,\n      opts = it.opts;\n\n  if (schemaEnv.$async) {\n    // TODO assign unevaluated\n    gen.if((0, codegen_1._)(_templateObject27 || (_templateObject27 = _taggedTemplateLiteral([\"\", \" === 0\"])), names_1.default.errors), function () {\n      return gen.return(names_1.default.data);\n    }, function () {\n      return gen.throw((0, codegen_1._)(_templateObject28 || (_templateObject28 = _taggedTemplateLiteral([\"new \", \"(\", \")\"])), ValidationError, names_1.default.vErrors));\n    });\n  } else {\n    gen.assign((0, codegen_1._)(_templateObject29 || (_templateObject29 = _taggedTemplateLiteral([\"\", \".errors\"])), validateName), names_1.default.vErrors);\n    if (opts.unevaluated) assignEvaluated(it);\n    gen.return((0, codegen_1._)(_templateObject30 || (_templateObject30 = _taggedTemplateLiteral([\"\", \" === 0\"])), names_1.default.errors));\n  }\n}\n\nfunction assignEvaluated(_ref4) {\n  var gen = _ref4.gen,\n      evaluated = _ref4.evaluated,\n      props = _ref4.props,\n      items = _ref4.items;\n  if (props instanceof codegen_1.Name) gen.assign((0, codegen_1._)(_templateObject31 || (_templateObject31 = _taggedTemplateLiteral([\"\", \".props\"])), evaluated), props);\n  if (items instanceof codegen_1.Name) gen.assign((0, codegen_1._)(_templateObject32 || (_templateObject32 = _taggedTemplateLiteral([\"\", \".items\"])), evaluated), items);\n}\n\nfunction schemaKeywords(it, types, typeErrors, errsCount) {\n  var gen = it.gen,\n      schema = it.schema,\n      data = it.data,\n      allErrors = it.allErrors,\n      opts = it.opts,\n      self = it.self;\n  var RULES = self.RULES;\n\n  if (schema.$ref && (opts.ignoreKeywordsWithRef || !(0, util_1.schemaHasRulesButRef)(schema, RULES))) {\n    gen.block(function () {\n      return keywordCode(it, \"$ref\", RULES.all.$ref.definition);\n    }); // TODO typecast\n\n    return;\n  }\n\n  if (!opts.jtd) checkStrictTypes(it, types);\n  gen.block(function () {\n    var _iterator = _createForOfIteratorHelper(RULES.rules),\n        _step;\n\n    try {\n      for (_iterator.s(); !(_step = _iterator.n()).done;) {\n        var group = _step.value;\n        groupKeywords(group);\n      }\n    } catch (err) {\n      _iterator.e(err);\n    } finally {\n      _iterator.f();\n    }\n\n    groupKeywords(RULES.post);\n  });\n\n  function groupKeywords(group) {\n    if (!(0, applicability_1.shouldUseGroup)(schema, group)) return;\n\n    if (group.type) {\n      gen.if((0, dataType_2.checkDataType)(group.type, data, opts.strictNumbers));\n      iterateKeywords(it, group);\n\n      if (types.length === 1 && types[0] === group.type && typeErrors) {\n        gen.else();\n        (0, dataType_2.reportTypeError)(it);\n      }\n\n      gen.endIf();\n    } else {\n      iterateKeywords(it, group);\n    } // TODO make it \"ok\" call?\n\n\n    if (!allErrors) gen.if((0, codegen_1._)(_templateObject33 || (_templateObject33 = _taggedTemplateLiteral([\"\", \" === \", \"\"])), names_1.default.errors, errsCount || 0));\n  }\n}\n\nfunction iterateKeywords(it, group) {\n  var gen = it.gen,\n      schema = it.schema,\n      useDefaults = it.opts.useDefaults;\n  if (useDefaults) (0, defaults_1.assignDefaults)(it, group.type);\n  gen.block(function () {\n    var _iterator2 = _createForOfIteratorHelper(group.rules),\n        _step2;\n\n    try {\n      for (_iterator2.s(); !(_step2 = _iterator2.n()).done;) {\n        var rule = _step2.value;\n\n        if ((0, applicability_1.shouldUseRule)(schema, rule)) {\n          keywordCode(it, rule.keyword, rule.definition, group.type);\n        }\n      }\n    } catch (err) {\n      _iterator2.e(err);\n    } finally {\n      _iterator2.f();\n    }\n  });\n}\n\nfunction checkStrictTypes(it, types) {\n  if (it.schemaEnv.meta || !it.opts.strictTypes) return;\n  checkContextTypes(it, types);\n  if (!it.opts.allowUnionTypes) checkMultipleTypes(it, types);\n  checkKeywordTypes(it, it.dataTypes);\n}\n\nfunction checkContextTypes(it, types) {\n  if (!types.length) return;\n\n  if (!it.dataTypes.length) {\n    it.dataTypes = types;\n    return;\n  }\n\n  types.forEach(function (t) {\n    if (!includesType(it.dataTypes, t)) {\n      strictTypesError(it, \"type \\\"\".concat(t, \"\\\" not allowed by context \\\"\").concat(it.dataTypes.join(\",\"), \"\\\"\"));\n    }\n  });\n  it.dataTypes = it.dataTypes.filter(function (t) {\n    return includesType(types, t);\n  });\n}\n\nfunction checkMultipleTypes(it, ts) {\n  if (ts.length > 1 && !(ts.length === 2 && ts.includes(\"null\"))) {\n    strictTypesError(it, \"use allowUnionTypes to allow union type keyword\");\n  }\n}\n\nfunction checkKeywordTypes(it, ts) {\n  var rules = it.self.RULES.all;\n\n  for (var keyword in rules) {\n    var rule = rules[keyword];\n\n    if (_typeof(rule) == \"object\" && (0, applicability_1.shouldUseRule)(it.schema, rule)) {\n      var type = rule.definition.type;\n\n      if (type.length && !type.some(function (t) {\n        return hasApplicableType(ts, t);\n      })) {\n        strictTypesError(it, \"missing type \\\"\".concat(type.join(\",\"), \"\\\" for keyword \\\"\").concat(keyword, \"\\\"\"));\n      }\n    }\n  }\n}\n\nfunction hasApplicableType(schTs, kwdT) {\n  return schTs.includes(kwdT) || kwdT === \"number\" && schTs.includes(\"integer\");\n}\n\nfunction includesType(ts, t) {\n  return ts.includes(t) || t === \"integer\" && ts.includes(\"number\");\n}\n\nfunction strictTypesError(it, msg) {\n  var schemaPath = it.schemaEnv.baseId + it.errSchemaPath;\n  msg += \" at \\\"\".concat(schemaPath, \"\\\" (strictTypes)\");\n  (0, util_1.checkStrictMode)(it, msg, it.opts.strictTypes);\n}\n\nvar KeywordCxt = /*#__PURE__*/function () {\n  function KeywordCxt(it, def, keyword) {\n    _classCallCheck(this, KeywordCxt);\n\n    (0, keyword_1.validateKeywordUsage)(it, def, keyword);\n    this.gen = it.gen;\n    this.allErrors = it.allErrors;\n    this.keyword = keyword;\n    this.data = it.data;\n    this.schema = it.schema[keyword];\n    this.$data = def.$data && it.opts.$data && this.schema && this.schema.$data;\n    this.schemaValue = (0, util_1.schemaRefOrVal)(it, this.schema, keyword, this.$data);\n    this.schemaType = def.schemaType;\n    this.parentSchema = it.schema;\n    this.params = {};\n    this.it = it;\n    this.def = def;\n\n    if (this.$data) {\n      this.schemaCode = it.gen.const(\"vSchema\", getData(this.$data, it));\n    } else {\n      this.schemaCode = this.schemaValue;\n\n      if (!(0, keyword_1.validSchemaType)(this.schema, def.schemaType, def.allowUndefined)) {\n        throw new Error(\"\".concat(keyword, \" value must be \").concat(JSON.stringify(def.schemaType)));\n      }\n    }\n\n    if (\"code\" in def ? def.trackErrors : def.errors !== false) {\n      this.errsCount = it.gen.const(\"_errs\", names_1.default.errors);\n    }\n  }\n\n  _createClass(KeywordCxt, [{\n    key: \"result\",\n    value: function result(condition, successAction, failAction) {\n      this.failResult((0, codegen_1.not)(condition), successAction, failAction);\n    }\n  }, {\n    key: \"failResult\",\n    value: function failResult(condition, successAction, failAction) {\n      this.gen.if(condition);\n      if (failAction) failAction();else this.error();\n\n      if (successAction) {\n        this.gen.else();\n        successAction();\n        if (this.allErrors) this.gen.endIf();\n      } else {\n        if (this.allErrors) this.gen.endIf();else this.gen.else();\n      }\n    }\n  }, {\n    key: \"pass\",\n    value: function pass(condition, failAction) {\n      this.failResult((0, codegen_1.not)(condition), undefined, failAction);\n    }\n  }, {\n    key: \"fail\",\n    value: function fail(condition) {\n      if (condition === undefined) {\n        this.error();\n        if (!this.allErrors) this.gen.if(false); // this branch will be removed by gen.optimize\n\n        return;\n      }\n\n      this.gen.if(condition);\n      this.error();\n      if (this.allErrors) this.gen.endIf();else this.gen.else();\n    }\n  }, {\n    key: \"fail$data\",\n    value: function fail$data(condition) {\n      if (!this.$data) return this.fail(condition);\n      var schemaCode = this.schemaCode;\n      this.fail((0, codegen_1._)(_templateObject34 || (_templateObject34 = _taggedTemplateLiteral([\"\", \" !== undefined && (\", \")\"])), schemaCode, (0, codegen_1.or)(this.invalid$data(), condition)));\n    }\n  }, {\n    key: \"error\",\n    value: function error(append, errorParams, errorPaths) {\n      if (errorParams) {\n        this.setParams(errorParams);\n\n        this._error(append, errorPaths);\n\n        this.setParams({});\n        return;\n      }\n\n      this._error(append, errorPaths);\n    }\n  }, {\n    key: \"_error\",\n    value: function _error(append, errorPaths) {\n      ;\n      (append ? errors_1.reportExtraError : errors_1.reportError)(this, this.def.error, errorPaths);\n    }\n  }, {\n    key: \"$dataError\",\n    value: function $dataError() {\n      (0, errors_1.reportError)(this, this.def.$dataError || errors_1.keyword$DataError);\n    }\n  }, {\n    key: \"reset\",\n    value: function reset() {\n      if (this.errsCount === undefined) throw new Error('add \"trackErrors\" to keyword definition');\n      (0, errors_1.resetErrorsCount)(this.gen, this.errsCount);\n    }\n  }, {\n    key: \"ok\",\n    value: function ok(cond) {\n      if (!this.allErrors) this.gen.if(cond);\n    }\n  }, {\n    key: \"setParams\",\n    value: function setParams(obj, assign) {\n      if (assign) Object.assign(this.params, obj);else this.params = obj;\n    }\n  }, {\n    key: \"block$data\",\n    value: function block$data(valid, codeBlock) {\n      var _this = this;\n\n      var $dataValid = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : codegen_1.nil;\n      this.gen.block(function () {\n        _this.check$data(valid, $dataValid);\n\n        codeBlock();\n      });\n    }\n  }, {\n    key: \"check$data\",\n    value: function check$data() {\n      var valid = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : codegen_1.nil;\n      var $dataValid = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : codegen_1.nil;\n      if (!this.$data) return;\n      var gen = this.gen,\n          schemaCode = this.schemaCode,\n          schemaType = this.schemaType,\n          def = this.def;\n      gen.if((0, codegen_1.or)((0, codegen_1._)(_templateObject35 || (_templateObject35 = _taggedTemplateLiteral([\"\", \" === undefined\"])), schemaCode), $dataValid));\n      if (valid !== codegen_1.nil) gen.assign(valid, true);\n\n      if (schemaType.length || def.validateSchema) {\n        gen.elseIf(this.invalid$data());\n        this.$dataError();\n        if (valid !== codegen_1.nil) gen.assign(valid, false);\n      }\n\n      gen.else();\n    }\n  }, {\n    key: \"invalid$data\",\n    value: function invalid$data() {\n      var gen = this.gen,\n          schemaCode = this.schemaCode,\n          schemaType = this.schemaType,\n          def = this.def,\n          it = this.it;\n      return (0, codegen_1.or)(wrong$DataType(), invalid$DataSchema());\n\n      function wrong$DataType() {\n        if (schemaType.length) {\n          /* istanbul ignore if */\n          if (!(schemaCode instanceof codegen_1.Name)) throw new Error(\"ajv implementation error\");\n          var st = Array.isArray(schemaType) ? schemaType : [schemaType];\n          return (0, codegen_1._)(_templateObject36 || (_templateObject36 = _taggedTemplateLiteral([\"\", \"\"])), (0, dataType_2.checkDataTypes)(st, schemaCode, it.opts.strictNumbers, dataType_2.DataType.Wrong));\n        }\n\n        return codegen_1.nil;\n      }\n\n      function invalid$DataSchema() {\n        if (def.validateSchema) {\n          var validateSchemaRef = gen.scopeValue(\"validate$data\", {\n            ref: def.validateSchema\n          }); // TODO value.code for standalone\n\n          return (0, codegen_1._)(_templateObject37 || (_templateObject37 = _taggedTemplateLiteral([\"!\", \"(\", \")\"])), validateSchemaRef, schemaCode);\n        }\n\n        return codegen_1.nil;\n      }\n    }\n  }, {\n    key: \"subschema\",\n    value: function subschema(appl, valid) {\n      var subschema = (0, subschema_1.getSubschema)(this.it, appl);\n      (0, subschema_1.extendSubschemaData)(subschema, this.it, appl);\n      (0, subschema_1.extendSubschemaMode)(subschema, appl);\n\n      var nextContext = _objectSpread(_objectSpread(_objectSpread({}, this.it), subschema), {}, {\n        items: undefined,\n        props: undefined\n      });\n\n      subschemaCode(nextContext, valid);\n      return nextContext;\n    }\n  }, {\n    key: \"mergeEvaluated\",\n    value: function mergeEvaluated(schemaCxt, toName) {\n      var it = this.it,\n          gen = this.gen;\n      if (!it.opts.unevaluated) return;\n\n      if (it.props !== true && schemaCxt.props !== undefined) {\n        it.props = util_1.mergeEvaluated.props(gen, schemaCxt.props, it.props, toName);\n      }\n\n      if (it.items !== true && schemaCxt.items !== undefined) {\n        it.items = util_1.mergeEvaluated.items(gen, schemaCxt.items, it.items, toName);\n      }\n    }\n  }, {\n    key: \"mergeValidEvaluated\",\n    value: function mergeValidEvaluated(schemaCxt, valid) {\n      var _this2 = this;\n\n      var it = this.it,\n          gen = this.gen;\n\n      if (it.opts.unevaluated && (it.props !== true || it.items !== true)) {\n        gen.if(valid, function () {\n          return _this2.mergeEvaluated(schemaCxt, codegen_1.Name);\n        });\n        return true;\n      }\n    }\n  }]);\n\n  return KeywordCxt;\n}();\n\nexports.KeywordCxt = KeywordCxt;\n\nfunction keywordCode(it, keyword, def, ruleType) {\n  var cxt = new KeywordCxt(it, def, keyword);\n\n  if (\"code\" in def) {\n    def.code(cxt, ruleType);\n  } else if (cxt.$data && def.validate) {\n    (0, keyword_1.funcKeywordCode)(cxt, def);\n  } else if (\"macro\" in def) {\n    (0, keyword_1.macroKeywordCode)(cxt, def);\n  } else if (def.compile || def.validate) {\n    (0, keyword_1.funcKeywordCode)(cxt, def);\n  }\n}\n\nvar JSON_POINTER = /^\\/(?:[^~]|~0|~1)*$/;\nvar RELATIVE_JSON_POINTER = /^([0-9]+)(#|\\/(?:[^~]|~0|~1)*)?$/;\n\nfunction getData($data, _ref5) {\n  var dataLevel = _ref5.dataLevel,\n      dataNames = _ref5.dataNames,\n      dataPathArr = _ref5.dataPathArr;\n  var jsonPointer;\n  var data;\n  if ($data === \"\") return names_1.default.rootData;\n\n  if ($data[0] === \"/\") {\n    if (!JSON_POINTER.test($data)) throw new Error(\"Invalid JSON-pointer: \".concat($data));\n    jsonPointer = $data;\n    data = names_1.default.rootData;\n  } else {\n    var matches = RELATIVE_JSON_POINTER.exec($data);\n    if (!matches) throw new Error(\"Invalid JSON-pointer: \".concat($data));\n    var up = +matches[1];\n    jsonPointer = matches[2];\n\n    if (jsonPointer === \"#\") {\n      if (up >= dataLevel) throw new Error(errorMsg(\"property/index\", up));\n      return dataPathArr[dataLevel - up];\n    }\n\n    if (up > dataLevel) throw new Error(errorMsg(\"data\", up));\n    data = dataNames[dataLevel - up];\n    if (!jsonPointer) return data;\n  }\n\n  var expr = data;\n  var segments = jsonPointer.split(\"/\");\n\n  var _iterator3 = _createForOfIteratorHelper(segments),\n      _step3;\n\n  try {\n    for (_iterator3.s(); !(_step3 = _iterator3.n()).done;) {\n      var segment = _step3.value;\n\n      if (segment) {\n        data = (0, codegen_1._)(_templateObject38 || (_templateObject38 = _taggedTemplateLiteral([\"\", \"\", \"\"])), data, (0, codegen_1.getProperty)((0, util_1.unescapeJsonPointer)(segment)));\n        expr = (0, codegen_1._)(_templateObject39 || (_templateObject39 = _taggedTemplateLiteral([\"\", \" && \", \"\"])), expr, data);\n      }\n    }\n  } catch (err) {\n    _iterator3.e(err);\n  } finally {\n    _iterator3.f();\n  }\n\n  return expr;\n\n  function errorMsg(pointerType, up) {\n    return \"Cannot access \".concat(pointerType, \" \").concat(up, \" levels up, current level is \").concat(dataLevel);\n  }\n}\n\nexports.getData = getData;","map":{"version":3,"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AASA;;AACA;;AACA;;AACA;;AACA;;AACA;;AACA;;AACA;;AACA;;AACA;;AACA;;AASA,oC,CAQA;;;AACA,SAAgBA,oBAAhB,CAAqCC,EAArC,EAAkD;AAChD,MAAIC,WAAW,CAACD,EAAD,CAAf,EAAqB;AACnBE,iBAAa,CAACF,EAAD,CAAb;;AACA,QAAIG,iBAAiB,CAACH,EAAD,CAArB,EAA2B;AACzBI,sBAAgB,CAACJ,EAAD,CAAhB;AACA;AACD;AACF;;AACDK,kBAAgB,CAACL,EAAD,EAAK;AAAA,WAAM,uCAAqBA,EAArB,CAAN;AAAA,GAAL,CAAhB;AACD;;AATDM;;AAWA,SAASD,gBAAT,OAEEE,IAFF,EAEa;AAAA,MADVC,GACU,QADVA,GACU;AAAA,MADLC,YACK,QADLA,YACK;AAAA,MADSC,MACT,QADSA,MACT;AAAA,MADiBC,SACjB,QADiBA,SACjB;AAAA,MAD4BC,IAC5B,QAD4BA,IAC5B;;AAEX,MAAIA,IAAI,CAACC,IAAL,CAAUC,GAAd,EAAmB;AACjBN,OAAG,CAACO,IAAJ,CAASN,YAAT,GAAuB,cAAvB,iFAA2BO,gBAAEC,IAA7B,EAAsCD,gBAAEE,MAAxC,GAAkDP,SAAS,CAACQ,MAA5D,EAAoE,YAAK;AACvEX,SAAG,CAACK,IAAJ,EAAS,cAAT,6FAA2BO,aAAa,CAACV,MAAD,EAASE,IAAT,CAAxC;AACAS,0BAAoB,CAACb,GAAD,EAAMI,IAAN,CAApB;AACAJ,SAAG,CAACK,IAAJ,CAASN,IAAT;AACD,KAJD;AAKD,GAND,MAMO;AACLC,OAAG,CAACO,IAAJ,CAASN,YAAT,GAAuB,cAAvB,mFAA2BO,gBAAEC,IAA7B,EAAsCK,iBAAiB,CAACV,IAAD,CAAvD,GAAiED,SAAS,CAACQ,MAA3E,EAAmF;AAAA,aACjFX,GAAG,CAACK,IAAJ,CAASO,aAAa,CAACV,MAAD,EAASE,IAAT,CAAtB,EAAsCC,IAAtC,CAA2CN,IAA3C,CADiF;AAAA,KAAnF;AAGD;AACF;;AAED,SAASe,iBAAT,CAA2BV,IAA3B,EAAgD;AAC9C,UAAO,cAAP,kHAAYI,gBAAEO,YAAd,EAAkCP,gBAAEQ,UAApC,EAAmDR,gBAAES,kBAArD,EAA4ET,gBAAEU,QAA9E,EACEV,gBAAEC,IADJ,EAEGL,IAAI,CAACe,UAAL,IAAkB,cAAlB,kFAAwBX,gBAAEY,cAA1B,IAAgDC,aAFnD;AAGD;;AAED,SAASR,oBAAT,CAA8Bb,GAA9B,EAA4CI,IAA5C,EAAiE;AAC/DJ,KAAG,CAACsB,EAAJ,CACEd,gBAAEE,MADJ,EAEE,YAAK;AACHV,OAAG,CAACuB,GAAJ,CAAQf,gBAAEO,YAAV,GAAwB,cAAxB,kFAA4BP,gBAAEE,MAA9B,EAAwCF,gBAAEO,YAA1C;AACAf,OAAG,CAACuB,GAAJ,CAAQf,gBAAEQ,UAAV,GAAsB,cAAtB,kFAA0BR,gBAAEE,MAA5B,EAAsCF,gBAAEQ,UAAxC;AACAhB,OAAG,CAACuB,GAAJ,CAAQf,gBAAES,kBAAV,GAA8B,cAA9B,kFAAkCT,gBAAEE,MAApC,EAA8CF,gBAAES,kBAAhD;AACAjB,OAAG,CAACuB,GAAJ,CAAQf,gBAAEU,QAAV,GAAoB,cAApB,kFAAwBV,gBAAEE,MAA1B,EAAoCF,gBAAEU,QAAtC;AACA,QAAId,IAAI,CAACe,UAAT,EAAqBnB,GAAG,CAACuB,GAAJ,CAAQf,gBAAEY,cAAV,GAA0B,cAA1B,oFAA8BZ,gBAAEE,MAAhC,EAA0CF,gBAAEY,cAA5C;AACtB,GARH,EASE,YAAK;AACHpB,OAAG,CAACuB,GAAJ,CAAQf,gBAAEO,YAAV,GAAwB,cAAxB;AACAf,OAAG,CAACuB,GAAJ,CAAQf,gBAAEQ,UAAV,GAAsB,cAAtB;AACAhB,OAAG,CAACuB,GAAJ,CAAQf,gBAAES,kBAAV,GAA8B,cAA9B;AACAjB,OAAG,CAACuB,GAAJ,CAAQf,gBAAEU,QAAV,EAAoBV,gBAAEC,IAAtB;AACA,QAAIL,IAAI,CAACe,UAAT,EAAqBnB,GAAG,CAACuB,GAAJ,CAAQf,gBAAEY,cAAV,GAA0B,cAA1B;AACtB,GAfH;AAiBD;;AAED,SAASxB,gBAAT,CAA0BJ,EAA1B,EAA0C;AACxC,MAAOU,MAAP,GAA4BV,EAA5B,CAAOU,MAAP;AAAA,MAAeE,IAAf,GAA4BZ,EAA5B,CAAeY,IAAf;AAAA,MAAqBJ,GAArB,GAA4BR,EAA5B,CAAqBQ,GAArB;AACAH,kBAAgB,CAACL,EAAD,EAAK,YAAK;AACxB,QAAIY,IAAI,CAACoB,QAAL,IAAiBtB,MAAM,CAACsB,QAA5B,EAAsCC,cAAc,CAACjC,EAAD,CAAd;AACtCkC,kBAAc,CAAClC,EAAD,CAAd;AACAQ,OAAG,CAAC2B,GAAJ,CAAQnB,gBAAEoB,OAAV,EAAmB,IAAnB;AACA5B,OAAG,CAAC2B,GAAJ,CAAQnB,gBAAEqB,MAAV,EAAkB,CAAlB;AACA,QAAIzB,IAAI,CAAC0B,WAAT,EAAsBC,cAAc,CAACvC,EAAD,CAAd;AACtBwC,mBAAe,CAACxC,EAAD,CAAf;AACAyC,iBAAa,CAACzC,EAAD,CAAb;AACD,GARe,CAAhB;AASA;AACD;;AAED,SAASuC,cAAT,CAAwBvC,EAAxB,EAAwC;AACtC;AACA,MAAOQ,GAAP,GAA4BR,EAA5B,CAAOQ,GAAP;AAAA,MAAYC,YAAZ,GAA4BT,EAA5B,CAAYS,YAAZ;AACAT,IAAE,CAAC0C,SAAH,GAAelC,GAAG,CAACmC,KAAJ,CAAU,WAAV,GAAuB,cAAvB,yFAA2BlC,YAA3B,EAAf;AACAD,KAAG,CAACsB,EAAJ,EAAO,cAAP,4FAAW9B,EAAE,CAAC0C,SAAd,GAAwC;AAAA,WAAMlC,GAAG,CAACoC,MAAJ,EAAW,cAAX,qFAAe5C,EAAE,CAAC0C,SAAlB,IAAqC,cAArC,oFAAN;AAAA,GAAxC;AACAlC,KAAG,CAACsB,EAAJ,EAAO,cAAP,4FAAW9B,EAAE,CAAC0C,SAAd,GAAwC;AAAA,WAAMlC,GAAG,CAACoC,MAAJ,EAAW,cAAX,qFAAe5C,EAAE,CAAC0C,SAAlB,IAAqC,cAArC,oFAAN;AAAA,GAAxC;AACD;;AAED,SAAStB,aAAT,CAAuBV,MAAvB,EAA0CE,IAA1C,EAA+D;AAC7D,MAAMiC,KAAK,GAAG,QAAOnC,MAAP,KAAiB,QAAjB,IAA6BA,MAAM,CAACE,IAAI,CAACkC,QAAN,CAAjD;AACA,SAAOD,KAAK,KAAKjC,IAAI,CAACC,IAAL,CAAUkC,MAAV,IAAoBnC,IAAI,CAACC,IAAL,CAAUmC,OAAnC,CAAL,IAAmD,cAAnD,gGAAqEH,KAArE,IAAkFhB,aAAzF;AACD,C,CAED;;;AACA,SAASoB,aAAT,CAAuBjD,EAAvB,EAAsCkD,KAAtC,EAAiD;AAC/C,MAAIjD,WAAW,CAACD,EAAD,CAAf,EAAqB;AACnBE,iBAAa,CAACF,EAAD,CAAb;;AACA,QAAIG,iBAAiB,CAACH,EAAD,CAArB,EAA2B;AACzBmD,sBAAgB,CAACnD,EAAD,EAAKkD,KAAL,CAAhB;AACA;AACD;AACF;;AACD,sCAAkBlD,EAAlB,EAAsBkD,KAAtB;AACD;;AAED,SAAS/C,iBAAT,QAAoD;AAAA,MAAxBO,MAAwB,SAAxBA,MAAwB;AAAA,MAAhB0C,IAAgB,SAAhBA,IAAgB;AAClD,MAAI,OAAO1C,MAAP,IAAiB,SAArB,EAAgC,OAAO,CAACA,MAAR;;AAChC,OAAK,IAAM2C,GAAX,IAAkB3C,MAAlB;AAA0B,QAAI0C,IAAI,CAACE,KAAL,CAAWC,GAAX,CAAeF,GAAf,CAAJ,EAAyB,OAAO,IAAP;AAAnD;;AACA,SAAO,KAAP;AACD;;AAED,SAASpD,WAAT,CAAqBD,EAArB,EAAkC;AAChC,SAAO,OAAOA,EAAE,CAACU,MAAV,IAAoB,SAA3B;AACD;;AAED,SAASyC,gBAAT,CAA0BnD,EAA1B,EAA4CkD,KAA5C,EAAuD;AACrD,MAAOxC,MAAP,GAA4BV,EAA5B,CAAOU,MAAP;AAAA,MAAeF,GAAf,GAA4BR,EAA5B,CAAeQ,GAAf;AAAA,MAAoBI,IAApB,GAA4BZ,EAA5B,CAAoBY,IAApB;AACA,MAAIA,IAAI,CAACoB,QAAL,IAAiBtB,MAAM,CAACsB,QAA5B,EAAsCC,cAAc,CAACjC,EAAD,CAAd;AACtCwD,eAAa,CAACxD,EAAD,CAAb;AACAyD,kBAAgB,CAACzD,EAAD,CAAhB;AACA,MAAM0D,SAAS,GAAGlD,GAAG,CAACmC,KAAJ,CAAU,OAAV,EAAmB3B,gBAAEqB,MAArB,CAAlB;AACAG,iBAAe,CAACxC,EAAD,EAAK0D,SAAL,CAAf,CANqD,CAOrD;;AACAlD,KAAG,CAACuB,GAAJ,CAAQmB,KAAR,GAAe,cAAf,wFAAmBQ,SAAnB,EAAoC1C,gBAAEqB,MAAtC;AACD;;AAED,SAASnC,aAAT,CAAuBF,EAAvB,EAAuC;AACrC,gCAAkBA,EAAlB;AACA2D,sBAAoB,CAAC3D,EAAD,CAApB;AACD;;AAED,SAASwC,eAAT,CAAyBxC,EAAzB,EAA2C0D,SAA3C,EAA2D;AACzD,MAAI1D,EAAE,CAACY,IAAH,CAAQgD,GAAZ,EAAiB,OAAOC,cAAc,CAAC7D,EAAD,EAAK,EAAL,EAAS,KAAT,EAAgB0D,SAAhB,CAArB;AACjB,MAAMI,KAAK,GAAG,+BAAe9D,EAAE,CAACU,MAAlB,CAAd;AACA,MAAMqD,YAAY,GAAG,uCAAuB/D,EAAvB,EAA2B8D,KAA3B,CAArB;AACAD,gBAAc,CAAC7D,EAAD,EAAK8D,KAAL,EAAY,CAACC,YAAb,EAA2BL,SAA3B,CAAd;AACD;;AAED,SAASC,oBAAT,CAA8B3D,EAA9B,EAA8C;AAC5C,MAAOU,MAAP,GAA4CV,EAA5C,CAAOU,MAAP;AAAA,MAAesD,aAAf,GAA4ChE,EAA5C,CAAegE,aAAf;AAAA,MAA8BpD,IAA9B,GAA4CZ,EAA5C,CAA8BY,IAA9B;AAAA,MAAoCwC,IAApC,GAA4CpD,EAA5C,CAAoCoD,IAApC;;AACA,MAAI1C,MAAM,CAACuD,IAAP,IAAerD,IAAI,CAACsD,qBAApB,IAA6C,iCAAqBxD,MAArB,EAA6B0C,IAAI,CAACE,KAAlC,CAAjD,EAA2F;AACzFF,QAAI,CAACe,MAAL,CAAYC,IAAZ,sDAA8DJ,aAA9D;AACD;AACF;;AAED,SAAS9B,cAAT,CAAwBlC,EAAxB,EAAwC;AACtC,MAAOU,MAAP,GAAuBV,EAAvB,CAAOU,MAAP;AAAA,MAAeE,IAAf,GAAuBZ,EAAvB,CAAeY,IAAf;;AACA,MAAIF,MAAM,CAAC2D,OAAP,KAAmBC,SAAnB,IAAgC1D,IAAI,CAAC2D,WAArC,IAAoD3D,IAAI,CAAC4D,YAA7D,EAA2E;AACzE,gCAAgBxE,EAAhB,EAAoB,uCAApB;AACD;AACF;;AAED,SAASwD,aAAT,CAAuBxD,EAAvB,EAAuC;AACrC,MAAM6C,KAAK,GAAG7C,EAAE,CAACU,MAAH,CAAUV,EAAE,CAACY,IAAH,CAAQkC,QAAlB,CAAd;AACA,MAAID,KAAJ,EAAW7C,EAAE,CAACyE,MAAH,GAAY,0BAAWzE,EAAE,CAACY,IAAH,CAAQ8D,WAAnB,EAAgC1E,EAAE,CAACyE,MAAnC,EAA2C5B,KAA3C,CAAZ;AACZ;;AAED,SAASY,gBAAT,CAA0BzD,EAA1B,EAA0C;AACxC,MAAIA,EAAE,CAACU,MAAH,CAAUS,MAAV,IAAoB,CAACnB,EAAE,CAACW,SAAH,CAAaQ,MAAtC,EAA8C,MAAM,IAAIwD,KAAJ,CAAU,6BAAV,CAAN;AAC/C;;AAED,SAAS1C,cAAT,QAAmF;AAAA,MAA1DzB,GAA0D,SAA1DA,GAA0D;AAAA,MAArDG,SAAqD,SAArDA,SAAqD;AAAA,MAA1CD,MAA0C,SAA1CA,MAA0C;AAAA,MAAlCsD,aAAkC,SAAlCA,aAAkC;AAAA,MAAnBpD,IAAmB,SAAnBA,IAAmB;AACjF,MAAMgE,GAAG,GAAGlE,MAAM,CAACsB,QAAnB;;AACA,MAAIpB,IAAI,CAACoB,QAAL,KAAkB,IAAtB,EAA4B;AAC1BxB,OAAG,CAACK,IAAJ,EAAS,cAAT,gGAAaG,gBAAEoC,IAAf,EAAkCwB,GAAlC;AACD,GAFD,MAEO,IAAI,OAAOhE,IAAI,CAACoB,QAAZ,IAAwB,UAA5B,EAAwC;AAC7C,QAAM6C,UAAU,IAAG,gBAAH,wFAASb,aAAT,CAAhB;AACA,QAAMc,QAAQ,GAAGtE,GAAG,CAACuE,UAAJ,CAAe,MAAf,EAAuB;AAACC,SAAG,EAAErE,SAAS,CAACsE;AAAhB,KAAvB,CAAjB;AACAzE,OAAG,CAACK,IAAJ,EAAS,cAAT,sHAAaG,gBAAEoC,IAAf,EAAqCwB,GAArC,EAA6CC,UAA7C,EAA4DC,QAA5D;AACD;AACF;;AAED,SAASrC,aAAT,CAAuBzC,EAAvB,EAAoC;AAClC,MAAOQ,GAAP,GAA8DR,EAA9D,CAAOQ,GAAP;AAAA,MAAYG,SAAZ,GAA8DX,EAA9D,CAAYW,SAAZ;AAAA,MAAuBF,YAAvB,GAA8DT,EAA9D,CAAuBS,YAAvB;AAAA,MAAqCyE,eAArC,GAA8DlF,EAA9D,CAAqCkF,eAArC;AAAA,MAAsDtE,IAAtD,GAA8DZ,EAA9D,CAAsDY,IAAtD;;AACA,MAAID,SAAS,CAACQ,MAAd,EAAsB;AACpB;AACAX,OAAG,CAACsB,EAAJ,EACE,cADF,qFACMd,gBAAEqB,MADR,GAEE;AAAA,aAAM7B,GAAG,CAAC2E,MAAJ,CAAWnE,gBAAEC,IAAb,CAAN;AAAA,KAFF,EAGE;AAAA,aAAMT,GAAG,CAAC4E,KAAJ,EAAU,cAAV,yFAAkBF,eAAlB,EAA6ClE,gBAAEoB,OAA/C,EAAN;AAAA,KAHF;AAKD,GAPD,MAOO;AACL5B,OAAG,CAACoC,MAAJ,EAAW,cAAX,sFAAenC,YAAf,GAAsCO,gBAAEoB,OAAxC;AACA,QAAIxB,IAAI,CAAC0B,WAAT,EAAsB+C,eAAe,CAACrF,EAAD,CAAf;AACtBQ,OAAG,CAAC2E,MAAJ,EAAW,cAAX,qFAAenE,gBAAEqB,MAAjB;AACD;AACF;;AAED,SAASgD,eAAT,QAAkE;AAAA,MAAxC7E,GAAwC,SAAxCA,GAAwC;AAAA,MAAnCkC,SAAmC,SAAnCA,SAAmC;AAAA,MAAxB4C,KAAwB,SAAxBA,KAAwB;AAAA,MAAjBC,KAAiB,SAAjBA,KAAiB;AAChE,MAAID,KAAK,YAAYzD,cAArB,EAA2BrB,GAAG,CAACoC,MAAJ,EAAW,cAAX,qFAAeF,SAAf,GAAkC4C,KAAlC;AAC3B,MAAIC,KAAK,YAAY1D,cAArB,EAA2BrB,GAAG,CAACoC,MAAJ,EAAW,cAAX,qFAAeF,SAAf,GAAkC6C,KAAlC;AAC5B;;AAED,SAAS1B,cAAT,CACE7D,EADF,EAEE8D,KAFF,EAGE0B,UAHF,EAIE9B,SAJF,EAIkB;AAEhB,MAAOlD,GAAP,GAAmDR,EAAnD,CAAOQ,GAAP;AAAA,MAAYE,MAAZ,GAAmDV,EAAnD,CAAYU,MAAZ;AAAA,MAAoBO,IAApB,GAAmDjB,EAAnD,CAAoBiB,IAApB;AAAA,MAA0BwE,SAA1B,GAAmDzF,EAAnD,CAA0ByF,SAA1B;AAAA,MAAqC7E,IAArC,GAAmDZ,EAAnD,CAAqCY,IAArC;AAAA,MAA2CwC,IAA3C,GAAmDpD,EAAnD,CAA2CoD,IAA3C;AACA,MAAOE,KAAP,GAAgBF,IAAhB,CAAOE,KAAP;;AACA,MAAI5C,MAAM,CAACuD,IAAP,KAAgBrD,IAAI,CAACsD,qBAAL,IAA8B,CAAC,iCAAqBxD,MAArB,EAA6B4C,KAA7B,CAA/C,CAAJ,EAAyF;AACvF9C,OAAG,CAACkF,KAAJ,CAAU;AAAA,aAAMC,WAAW,CAAC3F,EAAD,EAAK,MAAL,EAAcsD,KAAK,CAACC,GAAN,CAAUU,IAAV,CAAwB2B,UAAtC,CAAjB;AAAA,KAAV,EADuF,CACT;;AAC9E;AACD;;AACD,MAAI,CAAChF,IAAI,CAACgD,GAAV,EAAeiC,gBAAgB,CAAC7F,EAAD,EAAK8D,KAAL,CAAhB;AACftD,KAAG,CAACkF,KAAJ,CAAU,YAAK;AAAA,+CACOpC,KAAK,CAACwC,KADb;AAAA;;AAAA;AACb;AAAA,YAAWC,KAAX;AAAiCC,qBAAa,CAACD,KAAD,CAAb;AAAjC;AADa;AAAA;AAAA;AAAA;AAAA;;AAEbC,iBAAa,CAAC1C,KAAK,CAAC2C,IAAP,CAAb;AACD,GAHD;;AAKA,WAASD,aAAT,CAAuBD,KAAvB,EAAuC;AACrC,QAAI,CAAC,oCAAerF,MAAf,EAAuBqF,KAAvB,CAAL,EAAoC;;AACpC,QAAIA,KAAK,CAACG,IAAV,EAAgB;AACd1F,SAAG,CAACsB,EAAJ,CAAO,8BAAciE,KAAK,CAACG,IAApB,EAA0BjF,IAA1B,EAAgCL,IAAI,CAACuF,aAArC,CAAP;AACAC,qBAAe,CAACpG,EAAD,EAAK+F,KAAL,CAAf;;AACA,UAAIjC,KAAK,CAACuC,MAAN,KAAiB,CAAjB,IAAsBvC,KAAK,CAAC,CAAD,CAAL,KAAaiC,KAAK,CAACG,IAAzC,IAAiDV,UAArD,EAAiE;AAC/DhF,WAAG,CAAC8F,IAAJ;AACA,wCAAgBtG,EAAhB;AACD;;AACDQ,SAAG,CAAC+F,KAAJ;AACD,KARD,MAQO;AACLH,qBAAe,CAACpG,EAAD,EAAK+F,KAAL,CAAf;AACD,KAZoC,CAarC;;;AACA,QAAI,CAACN,SAAL,EAAgBjF,GAAG,CAACsB,EAAJ,EAAO,cAAP,wFAAWd,gBAAEqB,MAAb,EAA2BqB,SAAS,IAAI,CAAxC;AACjB;AACF;;AAED,SAAS0C,eAAT,CAAyBpG,EAAzB,EAA2C+F,KAA3C,EAA2D;AACzD,MACEvF,GADF,GAIIR,EAJJ,CACEQ,GADF;AAAA,MAEEE,MAFF,GAIIV,EAJJ,CAEEU,MAFF;AAAA,MAGS6D,WAHT,GAIIvE,EAJJ,CAGEY,IAHF,CAGS2D,WAHT;AAKA,MAAIA,WAAJ,EAAiB,+BAAevE,EAAf,EAAmB+F,KAAK,CAACG,IAAzB;AACjB1F,KAAG,CAACkF,KAAJ,CAAU,YAAK;AAAA,gDACMK,KAAK,CAACD,KADZ;AAAA;;AAAA;AACb,6DAAgC;AAAA,YAArBU,IAAqB;;AAC9B,YAAI,mCAAc9F,MAAd,EAAsB8F,IAAtB,CAAJ,EAAiC;AAC/Bb,qBAAW,CAAC3F,EAAD,EAAKwG,IAAI,CAACC,OAAV,EAAmBD,IAAI,CAACZ,UAAxB,EAAoCG,KAAK,CAACG,IAA1C,CAAX;AACD;AACF;AALY;AAAA;AAAA;AAAA;AAAA;AAMd,GAND;AAOD;;AAED,SAASL,gBAAT,CAA0B7F,EAA1B,EAA4C8D,KAA5C,EAA6D;AAC3D,MAAI9D,EAAE,CAACW,SAAH,CAAa+F,IAAb,IAAqB,CAAC1G,EAAE,CAACY,IAAH,CAAQ+F,WAAlC,EAA+C;AAC/CC,mBAAiB,CAAC5G,EAAD,EAAK8D,KAAL,CAAjB;AACA,MAAI,CAAC9D,EAAE,CAACY,IAAH,CAAQiG,eAAb,EAA8BC,kBAAkB,CAAC9G,EAAD,EAAK8D,KAAL,CAAlB;AAC9BiD,mBAAiB,CAAC/G,EAAD,EAAKA,EAAE,CAACgH,SAAR,CAAjB;AACD;;AAED,SAASJ,iBAAT,CAA2B5G,EAA3B,EAA6C8D,KAA7C,EAA8D;AAC5D,MAAI,CAACA,KAAK,CAACuC,MAAX,EAAmB;;AACnB,MAAI,CAACrG,EAAE,CAACgH,SAAH,CAAaX,MAAlB,EAA0B;AACxBrG,MAAE,CAACgH,SAAH,GAAelD,KAAf;AACA;AACD;;AACDA,OAAK,CAACmD,OAAN,CAAc,UAACC,CAAD,EAAM;AAClB,QAAI,CAACC,YAAY,CAACnH,EAAE,CAACgH,SAAJ,EAAeE,CAAf,CAAjB,EAAoC;AAClCE,sBAAgB,CAACpH,EAAD,mBAAckH,CAAd,yCAA4ClH,EAAE,CAACgH,SAAH,CAAaK,IAAb,CAAkB,GAAlB,CAA5C,QAAhB;AACD;AACF,GAJD;AAKArH,IAAE,CAACgH,SAAH,GAAehH,EAAE,CAACgH,SAAH,CAAaM,MAAb,CAAoB,UAACJ,CAAD;AAAA,WAAOC,YAAY,CAACrD,KAAD,EAAQoD,CAAR,CAAnB;AAAA,GAApB,CAAf;AACD;;AAED,SAASJ,kBAAT,CAA4B9G,EAA5B,EAA8CuH,EAA9C,EAA4D;AAC1D,MAAIA,EAAE,CAAClB,MAAH,GAAY,CAAZ,IAAiB,EAAEkB,EAAE,CAAClB,MAAH,KAAc,CAAd,IAAmBkB,EAAE,CAACC,QAAH,CAAY,MAAZ,CAArB,CAArB,EAAgE;AAC9DJ,oBAAgB,CAACpH,EAAD,EAAK,iDAAL,CAAhB;AACD;AACF;;AAED,SAAS+G,iBAAT,CAA2B/G,EAA3B,EAA6CuH,EAA7C,EAA2D;AACzD,MAAMzB,KAAK,GAAG9F,EAAE,CAACoD,IAAH,CAAQE,KAAR,CAAcC,GAA5B;;AACA,OAAK,IAAMkD,OAAX,IAAsBX,KAAtB,EAA6B;AAC3B,QAAMU,IAAI,GAAGV,KAAK,CAACW,OAAD,CAAlB;;AACA,QAAI,QAAOD,IAAP,KAAe,QAAf,IAA2B,mCAAcxG,EAAE,CAACU,MAAjB,EAAyB8F,IAAzB,CAA/B,EAA+D;AAC7D,UAAON,IAAP,GAAeM,IAAI,CAACZ,UAApB,CAAOM,IAAP;;AACA,UAAIA,IAAI,CAACG,MAAL,IAAe,CAACH,IAAI,CAACuB,IAAL,CAAU,UAACP,CAAD;AAAA,eAAOQ,iBAAiB,CAACH,EAAD,EAAKL,CAAL,CAAxB;AAAA,OAAV,CAApB,EAAgE;AAC9DE,wBAAgB,CAACpH,EAAD,2BAAsBkG,IAAI,CAACmB,IAAL,CAAU,GAAV,CAAtB,8BAAsDZ,OAAtD,QAAhB;AACD;AACF;AACF;AACF;;AAED,SAASiB,iBAAT,CAA2BC,KAA3B,EAA8CC,IAA9C,EAA4D;AAC1D,SAAOD,KAAK,CAACH,QAAN,CAAeI,IAAf,KAAyBA,IAAI,KAAK,QAAT,IAAqBD,KAAK,CAACH,QAAN,CAAe,SAAf,CAArD;AACD;;AAED,SAASL,YAAT,CAAsBI,EAAtB,EAAsCL,CAAtC,EAAiD;AAC/C,SAAOK,EAAE,CAACC,QAAH,CAAYN,CAAZ,KAAmBA,CAAC,KAAK,SAAN,IAAmBK,EAAE,CAACC,QAAH,CAAY,QAAZ,CAA7C;AACD;;AAED,SAASJ,gBAAT,CAA0BpH,EAA1B,EAA4C4E,GAA5C,EAAuD;AACrD,MAAMC,UAAU,GAAG7E,EAAE,CAACW,SAAH,CAAa8D,MAAb,GAAsBzE,EAAE,CAACgE,aAA5C;AACAY,KAAG,oBAAYC,UAAZ,qBAAH;AACA,8BAAgB7E,EAAhB,EAAoB4E,GAApB,EAAyB5E,EAAE,CAACY,IAAH,CAAQ+F,WAAjC;AACD;;IAEYkB,U;AAiBX,sBAAY7H,EAAZ,EAA8B8H,GAA9B,EAA2DrB,OAA3D,EAA0E;AAAA;;AACxE,wCAAqBzG,EAArB,EAAyB8H,GAAzB,EAA8BrB,OAA9B;AACA,SAAKjG,GAAL,GAAWR,EAAE,CAACQ,GAAd;AACA,SAAKiF,SAAL,GAAiBzF,EAAE,CAACyF,SAApB;AACA,SAAKgB,OAAL,GAAeA,OAAf;AACA,SAAKxF,IAAL,GAAYjB,EAAE,CAACiB,IAAf;AACA,SAAKP,MAAL,GAAcV,EAAE,CAACU,MAAH,CAAU+F,OAAV,CAAd;AACA,SAAKsB,KAAL,GAAaD,GAAG,CAACC,KAAJ,IAAa/H,EAAE,CAACY,IAAH,CAAQmH,KAArB,IAA8B,KAAKrH,MAAnC,IAA6C,KAAKA,MAAL,CAAYqH,KAAtE;AACA,SAAKC,WAAL,GAAmB,2BAAehI,EAAf,EAAmB,KAAKU,MAAxB,EAAgC+F,OAAhC,EAAyC,KAAKsB,KAA9C,CAAnB;AACA,SAAKE,UAAL,GAAkBH,GAAG,CAACG,UAAtB;AACA,SAAKC,YAAL,GAAoBlI,EAAE,CAACU,MAAvB;AACA,SAAKyH,MAAL,GAAc,EAAd;AACA,SAAKnI,EAAL,GAAUA,EAAV;AACA,SAAK8H,GAAL,GAAWA,GAAX;;AAEA,QAAI,KAAKC,KAAT,EAAgB;AACd,WAAKK,UAAL,GAAkBpI,EAAE,CAACQ,GAAH,CAAOmC,KAAP,CAAa,SAAb,EAAwB0F,OAAO,CAAC,KAAKN,KAAN,EAAa/H,EAAb,CAA/B,CAAlB;AACD,KAFD,MAEO;AACL,WAAKoI,UAAL,GAAkB,KAAKJ,WAAvB;;AACA,UAAI,CAAC,+BAAgB,KAAKtH,MAArB,EAA6BoH,GAAG,CAACG,UAAjC,EAA6CH,GAAG,CAACQ,cAAjD,CAAL,EAAuE;AACrE,cAAM,IAAI3D,KAAJ,WAAa8B,OAAb,4BAAsC8B,IAAI,CAACC,SAAL,CAAeV,GAAG,CAACG,UAAnB,CAAtC,EAAN;AACD;AACF;;AAED,QAAI,UAAUH,GAAV,GAAgBA,GAAG,CAACW,WAApB,GAAkCX,GAAG,CAACzF,MAAJ,KAAe,KAArD,EAA4D;AAC1D,WAAKqB,SAAL,GAAiB1D,EAAE,CAACQ,GAAH,CAAOmC,KAAP,CAAa,OAAb,EAAsB3B,gBAAEqB,MAAxB,CAAjB;AACD;AACF;;;;WAED,gBAAOqG,SAAP,EAAwBC,aAAxB,EAAoDC,UAApD,EAA2E;AACzE,WAAKC,UAAL,CAAgB,mBAAIH,SAAJ,CAAhB,EAAgCC,aAAhC,EAA+CC,UAA/C;AACD;;;WAED,oBAAWF,SAAX,EAA4BC,aAA5B,EAAwDC,UAAxD,EAA+E;AAC7E,WAAKpI,GAAL,CAASsB,EAAT,CAAY4G,SAAZ;AACA,UAAIE,UAAJ,EAAgBA,UAAU,GAA1B,KACK,KAAKE,KAAL;;AACL,UAAIH,aAAJ,EAAmB;AACjB,aAAKnI,GAAL,CAAS8F,IAAT;AACAqC,qBAAa;AACb,YAAI,KAAKlD,SAAT,EAAoB,KAAKjF,GAAL,CAAS+F,KAAT;AACrB,OAJD,MAIO;AACL,YAAI,KAAKd,SAAT,EAAoB,KAAKjF,GAAL,CAAS+F,KAAT,GAApB,KACK,KAAK/F,GAAL,CAAS8F,IAAT;AACN;AACF;;;WAED,cAAKoC,SAAL,EAAsBE,UAAtB,EAA6C;AAC3C,WAAKC,UAAL,CAAgB,mBAAIH,SAAJ,CAAhB,EAAgCpE,SAAhC,EAA2CsE,UAA3C;AACD;;;WAED,cAAKF,SAAL,EAAqB;AACnB,UAAIA,SAAS,KAAKpE,SAAlB,EAA6B;AAC3B,aAAKwE,KAAL;AACA,YAAI,CAAC,KAAKrD,SAAV,EAAqB,KAAKjF,GAAL,CAASsB,EAAT,CAAY,KAAZ,EAFM,CAEa;;AACxC;AACD;;AACD,WAAKtB,GAAL,CAASsB,EAAT,CAAY4G,SAAZ;AACA,WAAKI,KAAL;AACA,UAAI,KAAKrD,SAAT,EAAoB,KAAKjF,GAAL,CAAS+F,KAAT,GAApB,KACK,KAAK/F,GAAL,CAAS8F,IAAT;AACN;;;WAED,mBAAUoC,SAAV,EAAyB;AACvB,UAAI,CAAC,KAAKX,KAAV,EAAiB,OAAO,KAAKgB,IAAL,CAAUL,SAAV,CAAP;AACjB,UAAON,UAAP,GAAqB,IAArB,CAAOA,UAAP;AACA,WAAKW,IAAL,EAAU,cAAV,uGAAcX,UAAd,EAA8C,kBAAG,KAAKY,YAAL,EAAH,EAAwBN,SAAxB,CAA9C;AACD;;;WAED,eAAMO,MAAN,EAAwBC,WAAxB,EAAwDC,UAAxD,EAA+E;AAC7E,UAAID,WAAJ,EAAiB;AACf,aAAKE,SAAL,CAAeF,WAAf;;AACA,aAAKG,MAAL,CAAYJ,MAAZ,EAAoBE,UAApB;;AACA,aAAKC,SAAL,CAAe,EAAf;AACA;AACD;;AACD,WAAKC,MAAL,CAAYJ,MAAZ,EAAoBE,UAApB;AACD;;;WAEO,gBAAOF,MAAP,EAAyBE,UAAzB,EAAgD;AACtD;AAAC,OAACF,MAAM,GAAGK,yBAAH,GAAsBA,oBAA7B,EAA0C,IAA1C,EAAgD,KAAKxB,GAAL,CAASgB,KAAzD,EAAgEK,UAAhE;AACF;;;WAED,sBAAU;AACR,gCAAY,IAAZ,EAAkB,KAAKrB,GAAL,CAASyB,UAAT,IAAuBD,0BAAzC;AACD;;;WAED,iBAAK;AACH,UAAI,KAAK5F,SAAL,KAAmBY,SAAvB,EAAkC,MAAM,IAAIK,KAAJ,CAAU,yCAAV,CAAN;AAClC,qCAAiB,KAAKnE,GAAtB,EAA2B,KAAKkD,SAAhC;AACD;;;WAED,YAAG8F,IAAH,EAAuB;AACrB,UAAI,CAAC,KAAK/D,SAAV,EAAqB,KAAKjF,GAAL,CAASsB,EAAT,CAAY0H,IAAZ;AACtB;;;WAED,mBAAUC,GAAV,EAAiC7G,MAAjC,EAA8C;AAC5C,UAAIA,MAAJ,EAAY8G,MAAM,CAAC9G,MAAP,CAAc,KAAKuF,MAAnB,EAA2BsB,GAA3B,EAAZ,KACK,KAAKtB,MAAL,GAAcsB,GAAd;AACN;;;WAED,oBAAWvG,KAAX,EAAwByG,SAAxB,EAAqE;AAAA;;AAAA,UAAtBC,UAAsB,uEAAH/H,aAAG;AACnE,WAAKrB,GAAL,CAASkF,KAAT,CAAe,YAAK;AAClB,aAAI,CAACmE,UAAL,CAAgB3G,KAAhB,EAAuB0G,UAAvB;;AACAD,iBAAS;AACV,OAHD;AAID;;;WAED,sBAAoD;AAAA,UAAzCzG,KAAyC,uEAA3BrB,aAA2B;AAAA,UAAtB+H,UAAsB,uEAAH/H,aAAG;AAClD,UAAI,CAAC,KAAKkG,KAAV,EAAiB;AACjB,UAAOvH,GAAP,GAA2C,IAA3C,CAAOA,GAAP;AAAA,UAAY4H,UAAZ,GAA2C,IAA3C,CAAYA,UAAZ;AAAA,UAAwBH,UAAxB,GAA2C,IAA3C,CAAwBA,UAAxB;AAAA,UAAoCH,GAApC,GAA2C,IAA3C,CAAoCA,GAApC;AACAtH,SAAG,CAACsB,EAAJ,CAAO,mBAAG,cAAH,6FAAOsG,UAAP,GAAmCwB,UAAnC,CAAP;AACA,UAAI1G,KAAK,KAAKrB,aAAd,EAAmBrB,GAAG,CAACoC,MAAJ,CAAWM,KAAX,EAAkB,IAAlB;;AACnB,UAAI+E,UAAU,CAAC5B,MAAX,IAAqByB,GAAG,CAACgC,cAA7B,EAA6C;AAC3CtJ,WAAG,CAACuJ,MAAJ,CAAW,KAAKf,YAAL,EAAX;AACA,aAAKO,UAAL;AACA,YAAIrG,KAAK,KAAKrB,aAAd,EAAmBrB,GAAG,CAACoC,MAAJ,CAAWM,KAAX,EAAkB,KAAlB;AACpB;;AACD1C,SAAG,CAAC8F,IAAJ;AACD;;;WAED,wBAAY;AACV,UAAO9F,GAAP,GAA+C,IAA/C,CAAOA,GAAP;AAAA,UAAY4H,UAAZ,GAA+C,IAA/C,CAAYA,UAAZ;AAAA,UAAwBH,UAAxB,GAA+C,IAA/C,CAAwBA,UAAxB;AAAA,UAAoCH,GAApC,GAA+C,IAA/C,CAAoCA,GAApC;AAAA,UAAyC9H,EAAzC,GAA+C,IAA/C,CAAyCA,EAAzC;AACA,aAAO,kBAAGgK,cAAc,EAAjB,EAAqBC,kBAAkB,EAAvC,CAAP;;AAEA,eAASD,cAAT,GAAuB;AACrB,YAAI/B,UAAU,CAAC5B,MAAf,EAAuB;AACrB;AACA,cAAI,EAAE+B,UAAU,YAAYvG,cAAxB,CAAJ,EAAmC,MAAM,IAAI8C,KAAJ,CAAU,0BAAV,CAAN;AACnC,cAAMuF,EAAE,GAAGC,KAAK,CAACC,OAAN,CAAcnC,UAAd,IAA4BA,UAA5B,GAAyC,CAACA,UAAD,CAApD;AACA,kBAAO,cAAP,+EAAW,+BAAeiC,EAAf,EAAmB9B,UAAnB,EAA+BpI,EAAE,CAACY,IAAH,CAAQuF,aAAvC,EAAsDkE,oBAASC,KAA/D,CAAX;AACD;;AACD,eAAOzI,aAAP;AACD;;AAED,eAASoI,kBAAT,GAA2B;AACzB,YAAInC,GAAG,CAACgC,cAAR,EAAwB;AACtB,cAAMS,iBAAiB,GAAG/J,GAAG,CAACuE,UAAJ,CAAe,eAAf,EAAgC;AAACC,eAAG,EAAE8C,GAAG,CAACgC;AAAV,WAAhC,CAA1B,CADsB,CAC+D;;AACrF,kBAAO,cAAP,sFAAYS,iBAAZ,EAAiCnC,UAAjC;AACD;;AACD,eAAOvG,aAAP;AACD;AACF;;;WAED,mBAAU2I,IAAV,EAA+BtH,KAA/B,EAA0C;AACxC,UAAMuH,SAAS,GAAG,8BAAa,KAAKzK,EAAlB,EAAsBwK,IAAtB,CAAlB;AACA,2CAAoBC,SAApB,EAA+B,KAAKzK,EAApC,EAAwCwK,IAAxC;AACA,2CAAoBC,SAApB,EAA+BD,IAA/B;;AACA,UAAME,WAAW,iDAAO,KAAK1K,EAAZ,GAAmByK,SAAnB;AAA8BlF,aAAK,EAAEjB,SAArC;AAAgDgB,aAAK,EAAEhB;AAAvD,QAAjB;;AACArB,mBAAa,CAACyH,WAAD,EAAcxH,KAAd,CAAb;AACA,aAAOwH,WAAP;AACD;;;WAED,wBAAeC,SAAf,EAAqCC,MAArC,EAAyD;AACvD,UAAO5K,EAAP,GAAkB,IAAlB,CAAOA,EAAP;AAAA,UAAWQ,GAAX,GAAkB,IAAlB,CAAWA,GAAX;AACA,UAAI,CAACR,EAAE,CAACY,IAAH,CAAQ0B,WAAb,EAA0B;;AAC1B,UAAItC,EAAE,CAACsF,KAAH,KAAa,IAAb,IAAqBqF,SAAS,CAACrF,KAAV,KAAoBhB,SAA7C,EAAwD;AACtDtE,UAAE,CAACsF,KAAH,GAAWuF,sBAAevF,KAAf,CAAqB9E,GAArB,EAA0BmK,SAAS,CAACrF,KAApC,EAA2CtF,EAAE,CAACsF,KAA9C,EAAqDsF,MAArD,CAAX;AACD;;AACD,UAAI5K,EAAE,CAACuF,KAAH,KAAa,IAAb,IAAqBoF,SAAS,CAACpF,KAAV,KAAoBjB,SAA7C,EAAwD;AACtDtE,UAAE,CAACuF,KAAH,GAAWsF,sBAAetF,KAAf,CAAqB/E,GAArB,EAA0BmK,SAAS,CAACpF,KAApC,EAA2CvF,EAAE,CAACuF,KAA9C,EAAqDqF,MAArD,CAAX;AACD;AACF;;;WAED,6BAAoBD,SAApB,EAA0CzH,KAA1C,EAAqD;AAAA;;AACnD,UAAOlD,EAAP,GAAkB,IAAlB,CAAOA,EAAP;AAAA,UAAWQ,GAAX,GAAkB,IAAlB,CAAWA,GAAX;;AACA,UAAIR,EAAE,CAACY,IAAH,CAAQ0B,WAAR,KAAwBtC,EAAE,CAACsF,KAAH,KAAa,IAAb,IAAqBtF,EAAE,CAACuF,KAAH,KAAa,IAA1D,CAAJ,EAAqE;AACnE/E,WAAG,CAACsB,EAAJ,CAAOoB,KAAP,EAAc;AAAA,iBAAM,MAAI,CAAC4H,cAAL,CAAoBH,SAApB,EAA+B9I,cAA/B,CAAN;AAAA,SAAd;AACA,eAAO,IAAP;AACD;AACF;;;;;;AA3LHvB;;AA8LA,SAASqF,WAAT,CACE3F,EADF,EAEEyG,OAFF,EAGEqB,GAHF,EAIEiD,QAJF,EAIqB;AAEnB,MAAMC,GAAG,GAAG,IAAInD,UAAJ,CAAe7H,EAAf,EAAmB8H,GAAnB,EAAwBrB,OAAxB,CAAZ;;AACA,MAAI,UAAUqB,GAAd,EAAmB;AACjBA,OAAG,CAACjH,IAAJ,CAASmK,GAAT,EAAcD,QAAd;AACD,GAFD,MAEO,IAAIC,GAAG,CAACjD,KAAJ,IAAaD,GAAG,CAACmD,QAArB,EAA+B;AACpC,mCAAgBD,GAAhB,EAAqBlD,GAArB;AACD,GAFM,MAEA,IAAI,WAAWA,GAAf,EAAoB;AACzB,oCAAiBkD,GAAjB,EAAsBlD,GAAtB;AACD,GAFM,MAEA,IAAIA,GAAG,CAACoD,OAAJ,IAAepD,GAAG,CAACmD,QAAvB,EAAiC;AACtC,mCAAgBD,GAAhB,EAAqBlD,GAArB;AACD;AACF;;AAED,IAAMqD,YAAY,GAAG,qBAArB;AACA,IAAMC,qBAAqB,GAAG,kCAA9B;;AACA,SAAgB/C,OAAhB,CACEN,KADF,SAEgD;AAAA,MAA7CsD,SAA6C,SAA7CA,SAA6C;AAAA,MAAlCC,SAAkC,SAAlCA,SAAkC;AAAA,MAAvBC,WAAuB,SAAvBA,WAAuB;AAE9C,MAAIC,WAAJ;AACA,MAAIvK,IAAJ;AACA,MAAI8G,KAAK,KAAK,EAAd,EAAkB,OAAO/G,gBAAEU,QAAT;;AAClB,MAAIqG,KAAK,CAAC,CAAD,CAAL,KAAa,GAAjB,EAAsB;AACpB,QAAI,CAACoD,YAAY,CAACM,IAAb,CAAkB1D,KAAlB,CAAL,EAA+B,MAAM,IAAIpD,KAAJ,iCAAmCoD,KAAnC,EAAN;AAC/ByD,eAAW,GAAGzD,KAAd;AACA9G,QAAI,GAAGD,gBAAEU,QAAT;AACD,GAJD,MAIO;AACL,QAAMgK,OAAO,GAAGN,qBAAqB,CAACO,IAAtB,CAA2B5D,KAA3B,CAAhB;AACA,QAAI,CAAC2D,OAAL,EAAc,MAAM,IAAI/G,KAAJ,iCAAmCoD,KAAnC,EAAN;AACd,QAAM6D,EAAE,GAAW,CAACF,OAAO,CAAC,CAAD,CAA3B;AACAF,eAAW,GAAGE,OAAO,CAAC,CAAD,CAArB;;AACA,QAAIF,WAAW,KAAK,GAApB,EAAyB;AACvB,UAAII,EAAE,IAAIP,SAAV,EAAqB,MAAM,IAAI1G,KAAJ,CAAUkH,QAAQ,CAAC,gBAAD,EAAmBD,EAAnB,CAAlB,CAAN;AACrB,aAAOL,WAAW,CAACF,SAAS,GAAGO,EAAb,CAAlB;AACD;;AACD,QAAIA,EAAE,GAAGP,SAAT,EAAoB,MAAM,IAAI1G,KAAJ,CAAUkH,QAAQ,CAAC,MAAD,EAASD,EAAT,CAAlB,CAAN;AACpB3K,QAAI,GAAGqK,SAAS,CAACD,SAAS,GAAGO,EAAb,CAAhB;AACA,QAAI,CAACJ,WAAL,EAAkB,OAAOvK,IAAP;AACnB;;AAED,MAAI6K,IAAI,GAAG7K,IAAX;AACA,MAAM8K,QAAQ,GAAGP,WAAW,CAACQ,KAAZ,CAAkB,GAAlB,CAAjB;;AAxB8C,8CAyBxBD,QAzBwB;AAAA;;AAAA;AAyB9C,2DAAgC;AAAA,UAArBE,OAAqB;;AAC9B,UAAIA,OAAJ,EAAa;AACXhL,YAAI,IAAG,cAAH,mFAAOA,IAAP,EAAc,2BAAY,gCAAoBgL,OAApB,CAAZ,CAAd,CAAJ;AACAH,YAAI,IAAG,cAAH,uFAAOA,IAAP,EAAkB7K,IAAlB,CAAJ;AACD;AACF;AA9B6C;AAAA;AAAA;AAAA;AAAA;;AA+B9C,SAAO6K,IAAP;;AAEA,WAASD,QAAT,CAAkBK,WAAlB,EAAuCN,EAAvC,EAAiD;AAC/C,mCAAwBM,WAAxB,cAAuCN,EAAvC,0CAAyEP,SAAzE;AACD;AACF;;AAtCD/K","names":["validateFunctionCode","it","isSchemaObj","checkKeywords","schemaCxtHasRules","topSchemaObjCode","validateFunction","exports","body","gen","validateName","schema","schemaEnv","opts","code","es5","func","names_1","data","valCxt","$async","funcSourceUrl","destructureValCxtES5","destructureValCxt","instancePath","parentData","parentDataProperty","rootData","dynamicRef","dynamicAnchors","codegen_1","if","var","$comment","commentKeyword","checkNoDefault","let","vErrors","errors","unevaluated","resetEvaluated","typeAndKeywords","returnResults","evaluated","const","assign","schId","schemaId","source","process","subschemaCode","valid","subSchemaObjCode","self","key","RULES","all","updateContext","checkAsyncSchema","errsCount","checkRefsAndKeywords","jtd","schemaKeywords","types","checkedTypes","errSchemaPath","$ref","ignoreKeywordsWithRef","logger","warn","default","undefined","useDefaults","strictSchema","baseId","uriResolver","Error","msg","schemaPath","rootName","scopeValue","ref","root","ValidationError","return","throw","assignEvaluated","props","items","typeErrors","allErrors","block","keywordCode","definition","checkStrictTypes","rules","group","groupKeywords","post","type","strictNumbers","iterateKeywords","length","else","endIf","rule","keyword","meta","strictTypes","checkContextTypes","allowUnionTypes","checkMultipleTypes","checkKeywordTypes","dataTypes","forEach","t","includesType","strictTypesError","join","filter","ts","includes","some","hasApplicableType","schTs","kwdT","KeywordCxt","def","$data","schemaValue","schemaType","parentSchema","params","schemaCode","getData","allowUndefined","JSON","stringify","trackErrors","condition","successAction","failAction","failResult","error","fail","invalid$data","append","errorParams","errorPaths","setParams","_error","errors_1","$dataError","cond","obj","Object","codeBlock","$dataValid","check$data","validateSchema","elseIf","wrong$DataType","invalid$DataSchema","st","Array","isArray","dataType_2","Wrong","validateSchemaRef","appl","subschema","nextContext","schemaCxt","toName","util_1","mergeEvaluated","ruleType","cxt","validate","compile","JSON_POINTER","RELATIVE_JSON_POINTER","dataLevel","dataNames","dataPathArr","jsonPointer","test","matches","exec","up","errorMsg","expr","segments","split","segment","pointerType"],"sourceRoot":"","sources":["../../../lib/compile/validate/index.ts"],"sourcesContent":[null]},"metadata":{},"sourceType":"script"}