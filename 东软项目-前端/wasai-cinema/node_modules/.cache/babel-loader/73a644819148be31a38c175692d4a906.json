{"ast":null,"code":"\"use strict\";\n\nvar _taggedTemplateLiteral = require(\"E:/DW/wasai-cinema/node_modules/@babel/runtime/helpers/taggedTemplateLiteral.js\").default;\n\nvar _createForOfIteratorHelper = require(\"E:/DW/wasai-cinema/node_modules/@babel/runtime/helpers/createForOfIteratorHelper.js\").default;\n\nvar _templateObject, _templateObject2;\n\nrequire(\"core-js/modules/es.array.filter.js\");\n\nrequire(\"core-js/modules/es.object.to-string.js\");\n\nrequire(\"core-js/modules/es.function.name.js\");\n\nrequire(\"core-js/modules/es.regexp.exec.js\");\n\nrequire(\"core-js/modules/es.regexp.test.js\");\n\nrequire(\"core-js/modules/es.regexp.constructor.js\");\n\nrequire(\"core-js/modules/es.regexp.dot-all.js\");\n\nrequire(\"core-js/modules/es.regexp.sticky.js\");\n\nrequire(\"core-js/modules/es.regexp.to-string.js\");\n\nrequire(\"core-js/modules/es.array.concat.js\");\n\nrequire(\"core-js/modules/es.array.includes.js\");\n\nrequire(\"core-js/modules/es.string.includes.js\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar code_1 = require(\"../code\");\n\nvar codegen_1 = require(\"../../compile/codegen\");\n\nvar util_1 = require(\"../../compile/util\");\n\nvar util_2 = require(\"../../compile/util\");\n\nvar def = {\n  keyword: \"patternProperties\",\n  type: \"object\",\n  schemaType: \"object\",\n  code: function code(cxt) {\n    var gen = cxt.gen,\n        schema = cxt.schema,\n        data = cxt.data,\n        parentSchema = cxt.parentSchema,\n        it = cxt.it;\n    var opts = it.opts;\n    var patterns = (0, code_1.allSchemaProperties)(schema);\n    var alwaysValidPatterns = patterns.filter(function (p) {\n      return (0, util_1.alwaysValidSchema)(it, schema[p]);\n    });\n\n    if (patterns.length === 0 || alwaysValidPatterns.length === patterns.length && (!it.opts.unevaluated || it.props === true)) {\n      return;\n    }\n\n    var checkProperties = opts.strictSchema && !opts.allowMatchingProperties && parentSchema.properties;\n    var valid = gen.name(\"valid\");\n\n    if (it.props !== true && !(it.props instanceof codegen_1.Name)) {\n      it.props = (0, util_2.evaluatedPropsToName)(gen, it.props);\n    }\n\n    var props = it.props;\n    validatePatternProperties();\n\n    function validatePatternProperties() {\n      var _iterator = _createForOfIteratorHelper(patterns),\n          _step;\n\n      try {\n        for (_iterator.s(); !(_step = _iterator.n()).done;) {\n          var pat = _step.value;\n          if (checkProperties) checkMatchingProperties(pat);\n\n          if (it.allErrors) {\n            validateProperties(pat);\n          } else {\n            gen.var(valid, true); // TODO var\n\n            validateProperties(pat);\n            gen.if(valid);\n          }\n        }\n      } catch (err) {\n        _iterator.e(err);\n      } finally {\n        _iterator.f();\n      }\n    }\n\n    function checkMatchingProperties(pat) {\n      for (var prop in checkProperties) {\n        if (new RegExp(pat).test(prop)) {\n          (0, util_1.checkStrictMode)(it, \"property \".concat(prop, \" matches pattern \").concat(pat, \" (use allowMatchingProperties)\"));\n        }\n      }\n    }\n\n    function validateProperties(pat) {\n      gen.forIn(\"key\", data, function (key) {\n        gen.if((0, codegen_1._)(_templateObject || (_templateObject = _taggedTemplateLiteral([\"\", \".test(\", \")\"])), (0, code_1.usePattern)(cxt, pat), key), function () {\n          var alwaysValid = alwaysValidPatterns.includes(pat);\n\n          if (!alwaysValid) {\n            cxt.subschema({\n              keyword: \"patternProperties\",\n              schemaProp: pat,\n              dataProp: key,\n              dataPropType: util_2.Type.Str\n            }, valid);\n          }\n\n          if (it.opts.unevaluated && props !== true) {\n            gen.assign((0, codegen_1._)(_templateObject2 || (_templateObject2 = _taggedTemplateLiteral([\"\", \"[\", \"]\"])), props, key), true);\n          } else if (!alwaysValid && !it.allErrors) {\n            // can short-circuit if `unevaluatedProperties` is not supported (opts.next === false)\n            // or if all properties were evaluated (props === true)\n            gen.if((0, codegen_1.not)(valid), function () {\n              return gen.break();\n            });\n          }\n        });\n      });\n    }\n  }\n};\nexports.default = def;","map":{"version":3,"mappings":"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","names":["def","keyword","type","schemaType","code","cxt","gen","schema","data","parentSchema","it","opts","patterns","alwaysValidPatterns","filter","p","length","unevaluated","props","checkProperties","strictSchema","allowMatchingProperties","properties","valid","name","codegen_1","validatePatternProperties","pat","checkMatchingProperties","allErrors","validateProperties","var","if","prop","RegExp","test","forIn","key","alwaysValid","includes","subschema","schemaProp","dataProp","dataPropType","util_2","Str","assign","break","exports"],"sourceRoot":"","sources":["../../../lib/vocabularies/applicator/patternProperties.ts"],"sourcesContent":[null]},"metadata":{},"sourceType":"script"}