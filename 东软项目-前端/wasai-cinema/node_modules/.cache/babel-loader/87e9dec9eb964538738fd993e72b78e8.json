{"ast":null,"code":"//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport { Register, IsExistUserName, SendEmailCode } from \"@/api/user\";\nexport default {\n  data() {\n    return {\n      reusername: \"\",\n      repassword: \"\",\n      repassword_recheck: \"\",\n      reemail: '',\n      emailCode: '',\n      ifcheck: false,\n      isPassEmail: true\n    };\n  },\n\n  methods: {\n    checkbox_change(e) {},\n\n    //判断用户名是否存在\n    isExistUserName() {\n      const vo = {\n        email: this.reusername\n      };\n      console.log(vo);\n      IsExistUserName(vo).then(res => {\n        console.log(res);\n\n        if (res.code == 200) {\n          if (res.data.success === \"success\") {\n            this.$message({\n              message: res.data.msg,\n              type: \"success\"\n            });\n          } else {\n            this.$message.error(res.data.msg);\n          }\n        }\n      });\n    },\n\n    //邮件输入框的失去焦点时间\n    checkEmail() {\n      const mailReg = /^([a-zA-Z0-9_-])+@([a-zA-Z0-9_-])+(.[a-zA-Z0-9_-])+/;\n\n      if (mailReg.test(this.reemail)) {\n        this.isPassEmail = true;\n      } else {\n        this.isPassEmail = false;\n      }\n\n      console.log(this.isPassEmail);\n    },\n\n    //发送email验证码\n    sendEmail() {\n      //客户端对传入的邮箱内容，进行基本的邮箱格式验证。验证成功后发消息到服务端。\n      //https://www.jb51.net/article/67628.htm\n      if (this.isPassEmail) {\n        const emailVo = {\n          email: this.reemail\n        };\n        console.log(emailVo); //如何发送\n\n        SendEmailCode(emailVo).then(res => {\n          console.log(res.data);\n\n          if (res.code == 200) {\n            this.$message({\n              message: res.data.msg,\n              type: \"success\"\n            }); //保存验证码\n\n            localStorage.setItem(\"code\", res.data.code);\n          }\n        });\n      } else {\n        this.$message({\n          message: '邮箱格式不正确',\n          type: \"warning\"\n        });\n      }\n    },\n\n    register() {\n      if (this.reusername.length < 6) {\n        this.$message({\n          message: \"请输入不少于六位的用户名\",\n          type: \"warning\"\n        });\n        return;\n      } else if (this.ifcheck == false) {\n        this.$message({\n          message: \"请勾选注册协议\",\n          type: \"warning\"\n        });\n        return;\n      } else if (this.repassword != this.repassword_recheck) {\n        this.$message({\n          message: \"请输入两次相同的密码\",\n          type: \"warning\"\n        });\n        return;\n      } else {\n        const register_info = {\n          username: this.reusername,\n          password: this.repassword,\n          email: this.reemail,\n          token: localStorage.getItem(\"code\"),\n          emailCode: this.emailCode\n        };\n        Register(register_info).then(res => {\n          if (res.code == 200) {\n            this.$message({\n              message: res.data.msg,\n              type: \"success\"\n            });\n            this.$router.push(\"/login\");\n          } else {\n            this.$message({\n              message: \"登陆失败\",\n              type: \"warning\"\n            });\n          }\n        });\n      }\n    }\n\n  }\n};","map":{"version":3,"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAsDA;AACA;AACAA;AACA;AACAC,oBADA;AAEAC,oBAFA;AAGAC,4BAHA;AAIAC,iBAJA;AAKAC,mBALA;AAMAC,oBANA;AAOAC;AAPA;AASA,GAXA;;AAYAC;AACAC,wBAEA,CAHA;;AAIA;AACAC;AACA;AACAC;AADA;AAGAC;AACAC;AACAD;;AACA;AACA;AACA;AACAE,mCADA;AAEAC;AAFA;AAIA,WALA,MAKA;AACA;AACA;AACA;AACA,OAZA;AAcA,KAxBA;;AAyBA;AACAC;AACA;;AACA;AACA;AACA,OAFA,MAEA;AACA;AACA;;AACAJ;AACA,KAlCA;;AAoCA;AACAK;AACA;AACA;AAEA;AACA;AACAN;AADA;AAGAC,6BAJA,CAMA;;AACAM;AACAN;;AACA;AACA;AACAE,mCADA;AAEAC;AAFA,eADA,CAKA;;AACAI;AACA;AACA,SAVA;AAWA,OAlBA,MAkBA;AACA;AACAL,4BADA;AAEAC;AAFA;AAKA;AACA,KAlEA;;AAmEAK;AACA;AACA;AACAN,iCADA;AAEAC;AAFA;AAIA;AACA,OANA,MAOA;AACA;AACAD,4BADA;AAEAC;AAFA;AAIA;AACA,OANA,MAOA;AACA;AACAD,+BADA;AAEAC;AAFA;AAIA;AACA,OANA,MAOA;AACA;AACAM,mCADA;AAEAC,mCAFA;AAGAX,6BAHA;AAIAY,6CAJA;AAKAlB;AALA;AAOAmB,4CACA;AACA,+BACA;AACA;AAAAV;AAAAC;AAAA;AACA;AAEA,WALA,MAMA;AACA;AAAAD;AAAAC;AAAA;AACA;AACA,SAXA;AAYA;AACA;;AA9GA;AAZA","names":["data","reusername","repassword","repassword_recheck","reemail","emailCode","ifcheck","isPassEmail","methods","checkbox_change","isExistUserName","email","console","IsExistUserName","message","type","checkEmail","sendEmail","SendEmailCode","localStorage","register","username","password","token","Register"],"sourceRoot":"src/views","sources":["register.vue"],"sourcesContent":["<template>\r\n  <div class=\"register\">\r\n\r\n\r\n\r\n    <div class=\"register_info\">\r\n          <div class=\"register_title\">\r\n         <!-- 插入图片 -->\r\n         <img src=\"../assets/img/logo.png\" />\r\n          <div class=\"register_text\">哇塞电影-注册</div>\r\n      </div>\r\n\r\n\r\n\r\n    \r\n\r\n    <div class=\"register_form\">\r\n     <p>Username</p>\r\n     <el-input v-model=\"reusername\" placeholder=\"账号\" @blur=\"isExistUserName\"></el-input>\r\n     <p>Password</p>\r\n     <el-input v-model=\"repassword\" placeholder=\"密码\" show-password></el-input>\r\n     <p>Check Password</p>\r\n     <el-input v-model=\"repassword_recheck\" placeholder=\"确认密码\" show-password></el-input>\r\n     <p>邮箱</p>\r\n     <el-input v-model=\"reemail\" placeholder=\"请输入邮箱\" @blur=\"checkEmail\"\r\n     :style=\"isPassEmail ?'':'border:1px solid red;'\"></el-input>\r\n     <el-button type=\"info\" icon=\"el-icon-message\" @click=\"sendEmail\" style=\"margin:4px 130px;position: relative;\">发送验证码</el-button>\r\n     <p>邮箱验证码</p>\r\n        <el-input\r\n          v-model=\"emailCode\"\r\n          placeholder=\"请输入验证码\"\r\n        ></el-input>\r\n    <div class=\"agreement\">\r\n      <el-checkbox v-model=\"ifcheck\" @change=\"checkbox_change\"><span class=\"check\">我已同意\"哇塞电影\"用户协议</span></el-checkbox>\r\n     </div>\r\n\r\n     \r\n       <div class=\"btn\"><el-button class=\"register_button\" type=\"primary\" @click=\"register()\">Register</el-button></div>\r\n    </div>\r\n\r\n     \r\n\r\n    <div class=\"register_footer\">\r\n     <el-link :underline=\"false\" class=\"rg\" href=\"#/login\">我有账号，去登陆<i class=\"el-icon-right\"></i></el-link>\r\n     <br />\r\n     <el-link :underline=\"false\" class=\"rg\" href=\"#/\">返回首页<i class=\"el-icon-left\"></i></el-link>\r\n\r\n     </div>\r\n    </div>\r\n  </div>\r\n  \r\n</template>\r\n\r\n<script>\r\nimport{Register,IsExistUserName,SendEmailCode} from \"@/api/user\";\r\nexport default {\r\n   data(){\r\n       return{\r\n            reusername:\"\",\r\n            repassword:\"\",\r\n            repassword_recheck:\"\",\r\n            reemail:'',\r\n            emailCode:'',\r\n            ifcheck:false,\r\n            isPassEmail:true,\r\n       }\r\n   },\r\n   methods:{\r\n       checkbox_change(e){\r\n           \r\n       },\r\n       //判断用户名是否存在\r\n\t\tisExistUserName(){\r\n\t\t\tconst vo = {\r\n\t\t\t\temail:this.reusername,\r\n\t\t\t}\r\n\t\t\tconsole.log(vo);\r\n\t\t\tIsExistUserName(vo).then((res)=>{\r\n\t\t\t\tconsole.log(res);\r\n\t\t\t\tif(res.code==200){\r\n\t\t\t\t\tif(res.data.success===\"success\"){\r\n\t\t\t\t\t\tthis.$message({\r\n\t\t\t\t\t\t\tmessage:res.data.msg,\r\n\t\t\t\t\t\t\ttype:\"success\"\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}else{\r\n\t\t\t\t\t\tthis.$message.error(res.data.msg);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\t\r\n\t\t}\t\t,\r\n       //邮件输入框的失去焦点时间\r\n\t\tcheckEmail(){\r\n\t\t\tconst mailReg = /^([a-zA-Z0-9_-])+@([a-zA-Z0-9_-])+(.[a-zA-Z0-9_-])+/ ;\r\n\t\t\tif(mailReg.test(this.reemail)){\r\n\t\t\t\tthis.isPassEmail=true;\r\n\t\t\t}else{\r\n\t\t\t\tthis.isPassEmail=false;\r\n\t\t\t}\r\n\t\t\tconsole.log(this.isPassEmail);\r\n\t\t},\r\n\t\t\r\n\t\t//发送email验证码\r\n\t\tsendEmail(){\r\n\t\t\t//客户端对传入的邮箱内容，进行基本的邮箱格式验证。验证成功后发消息到服务端。\r\n\t\t\t//https://www.jb51.net/article/67628.htm\r\n\t\t\r\n\t\t\tif(this.isPassEmail){\r\n\t\t\t\tconst emailVo={\r\n\t\t\t\t\temail:this.reemail,\r\n\t\t\t\t};\r\n\t\t\t\tconsole.log(emailVo);\r\n\t\t\t\t\r\n\t\t\t\t//如何发送\r\n\t\t\t\tSendEmailCode(emailVo).then((res)=>{\r\n\t\t\t\t\tconsole.log(res.data);\r\n\t\t\t\t\tif(res.code==200){\r\n\t\t\t\t\t\tthis.$message({\r\n\t\t\t\t\t\t\tmessage:res.data.msg,\r\n\t\t\t\t\t\t\ttype:\"success\"\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t\t//保存验证码\r\n\t\t\t\t\t\tlocalStorage.setItem(\"code\",res.data.code);\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t}else{\r\n\t\t\t\tthis.$message({\r\n\t\t\t\t\tmessage:'邮箱格式不正确',\r\n\t\t\t\t\ttype:\"warning\"\r\n\t\t\t\t})\r\n\t\t\t\t\r\n\t\t\t}\r\n\t\t},\r\n       register(){\r\n           if(this.reusername.length<6){\r\n               this.$message({\r\n                   message:\"请输入不少于六位的用户名\",\r\n                   type:\"warning\"\r\n               });\r\n               return;\r\n           }\r\n           else if(this.ifcheck==false){\r\n               this.$message({\r\n                   message:\"请勾选注册协议\",\r\n                   type:\"warning\"\r\n               });\r\n               return;\r\n           }\r\n           else if(this.repassword!=this.repassword_recheck){\r\n               this.$message({\r\n                   message:\"请输入两次相同的密码\",\r\n                   type:\"warning\"\r\n               });\r\n               return;\r\n           }\r\n           else{\r\n              const register_info={\r\n                  username:this.reusername,\r\n                  password:this.repassword,\r\n                  email:this.reemail,\r\n                  token:localStorage.getItem(\"code\"),\r\n                  emailCode:this.emailCode,\r\n              }\r\n              Register(register_info).then((res)=>\r\n              {\r\n                  if(res.code==200)\r\n                  {\r\n                      this.$message({message:res.data.msg,type:\"success\"});\r\n                      this.$router.push(\"/login\");\r\n\r\n                  }\r\n                  else{\r\n                      this.$message({message:\"登陆失败\",type:\"warning\"});\r\n                  }\r\n              })\r\n           }\r\n       }\r\n   }\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n.agreement{\r\n    margin-top: 20px;\r\n    \r\n}\r\n\r\n.check{\r\n    color:#91949c;\r\n    font-size:18px;\r\n}\r\n.register_title{\r\n    \r\n    height: 75px;\r\n}\r\n.register{\r\n    width: 100%;\r\n    height: 100%;\r\n}\r\n.register_info{\r\n    width:500px;\r\n    margin:50px auto;\r\n}\r\n.register_title img{\r\n    width:75px;\r\n    height:75px;\r\n    float:left;\r\n    margin-left: 60px;\r\n}\r\n.register_text{\r\n    float: left;\r\n    line-height: 75px;\r\n    font-size:30px;\r\n    font-weight: bold;\r\n    margin-left:60px ;\r\n}\r\n.register_form{\r\n    padding: 50px;\r\n    padding-top: 30px;\r\n    margin-top: 100px;\r\n    font-size:16px;\r\n    color:#91949c;\r\n    font-weight: bold;\r\n    border-color: rgba(151, 151, 151, 0.3);\r\n    border-style: solid;\r\n    border-width: 2px;\r\n    border-radius: 50px;\r\n}\r\n\r\n.register_button{\r\n    margin-top: 20px;\r\n    font-weight: bold;\r\n    width: 100%;\r\n    border-radius: 15px;\r\n}\r\n.register_footer{\r\n    height:50px;\r\n    line-height:50px;\r\n    text-align: center;\r\n    font-weight: bold;\r\n}\r\n.rg{\r\n    font-weight: bold;\r\n    font-size: 16px;\r\n    margin-top: 35px;\r\n}\r\n\r\n.btn{\r\n    clear: both;\r\n}\r\n</style>"]},"metadata":{},"sourceType":"module"}